<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='L√Ω thuy·∫øt thi·∫øt k·∫ø h·ªá th·ªëng'><title>System Design Basic</title>

<link rel='canonical' href='https://truongnh28.github.io/p/system-design-basic/'>

<link rel="stylesheet" href="/scss/style.min.450926226e724574a6b936335ea06111f8aeb253d932c86cb2cc807341cd2889.css"><meta property='og:title' content='System Design Basic'>
<meta property='og:description' content='L√Ω thuy·∫øt thi·∫øt k·∫ø h·ªá th·ªëng'>
<meta property='og:url' content='https://truongnh28.github.io/p/system-design-basic/'>
<meta property='og:site_name' content='Nguy·ªÖn H·ªØu Tr∆∞·ªüng'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='system design' /><meta property='article:tag' content='text' /><meta property='article:published_time' content='2022-05-14T00:00:00&#43;00:00'/><meta property='article:modified_time' content='2022-05-14T00:00:00&#43;00:00'/><meta property='og:image' content='https://truongnh28.github.io/p/system-design-basic/system_design.png' />
<meta name="twitter:title" content="System Design Basic">
<meta name="twitter:description" content="L√Ω thuy·∫øt thi·∫øt k·∫ø h·ªá th·ªëng"><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://truongnh28.github.io/p/system-design-basic/system_design.png' />
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu98d34193ef26d6536e438e405a9d9bf0_34688_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üç•</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Nguy·ªÖn H·ªØu Tr∆∞·ªüng</a></h1>
            <h2 class="site-description">BE</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://www.facebook.com/truongjr'
                        target="_blank"
                        title="Facebook"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-facebook" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <desc>Download more icon variants from https://tabler-icons.io/i/brand-facebook</desc>
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M7 10v4h3v7h4v-7h3l1 -4h-4v-2a1 1 0 0 1 1 -1h3v-4h-3a5 5 0 0 0 -5 5v2h-3" />
</svg>

                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/truongnh28'
                        target="_blank"
                        title="GitHub"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com'
                        target="_blank"
                        title="Twitter"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about-me/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About me</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        

        <li >
            <a href='/links/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5" />
  <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5" />
</svg>



                
                <span>Links</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>
<main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/system-design-basic/">
                <img src="/p/system-design-basic/system_design_huac571d42ebe43b23b89accb8e5d96ee3_114158_800x0_resize_box_3.png"
                        srcset="/p/system-design-basic/system_design_huac571d42ebe43b23b89accb8e5d96ee3_114158_800x0_resize_box_3.png 800w, /p/system-design-basic/system_design_huac571d42ebe43b23b89accb8e5d96ee3_114158_1600x0_resize_box_3.png 1600w"
                        width="800" 
                        height="541" 
                        loading="lazy"
                        alt="Featured image of post System Design Basic" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/system-design/" >
                System Design
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/system-design-basic/">System Design Basic</a>
        </h2>
    
        
        <h3 class="article-subtitle">
            L√Ω thuy·∫øt thi·∫øt k·∫ø h·ªá th·ªëng
        </h3>
        
    </div>

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">May 14, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    49 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>
</header>

    <section class="article-content">
    
    
    <h2 id="c√°c-t√≠nh-ch·∫•t-ch√≠nh-c·ªßa-m·ªôt-h·ªá-th·ªëng-ph√¢n-t√°n">C√°c t√≠nh ch·∫•t ch√≠nh c·ªßa m·ªôt h·ªá th·ªëng ph√¢n t√°n.</h2>
<p><code>H·ªá th·ªëng ph√¢n t√°n (distributed system) l√† h·ªá th·ªëng ph·∫ßn m·ªÅm m√† c√°c th√†nh ph·∫ßn c·∫•u t·∫°o n√™n n√≥ n·∫±m ·ªü tr√™n c√°c m√°y t√≠nh kh√°c nhau ƒë∆∞·ª£c k·∫øt n·ªëi th√†nh m·∫°ng l∆∞·ªõi (network). C√°c m√°y t√≠nh n√†y ph·ªëi h·ª£p ho·∫°t ƒë·ªông v·ªõi nhau ƒë·ªÉ ho√†n th√†nh m·ªôt nhi·ªám v·ª• chung b·∫±ng c√°ch trao ƒë·ªïi qua l·∫°i c√°c th√¥ng ƒëi·ªáp (message)</code></p>
<p>N√≥i n√¥m na l√† h·ªá th·ªëng ph√¢n t√°n l√† vi·ªác h·ªá th·ªëng b·∫°n c√≥ nhi·ªÅu qu√° tr√¨nh x·ª≠ l√Ω ƒë·ªôc l·∫≠p tr√™n nhi·ªÅu nhi·ªÅu server v·∫≠t l√Ω kh√°c nhau.</p>
<p>V·ªõi c√°c h·ªá th·ªëng doanh nghi·ªáp l·ªõn (enterprise) ƒë√≤i h·ªèi s·ª± linh ho·∫°t trong m·ªü r·ªông b·∫£o tr√¨ th√¨ distributed system l√† m·ªôt l·ª±a ch·ªçn ho√†n h·∫£o.V√† c√°c t√≠nh ch·∫•t ch√≠nh ƒë·ªÉ h√¨nh th√†nh m·ªôt h·ªá th·ªëng ph√¢n t√°n l√†: <strong>Kh·∫£ nƒÉng m·ªü r·ªông</strong>(Scalability), <strong>ƒê·ªô tin c·∫≠y</strong> (Reliability), <strong>T√≠nh kh·∫£ d·ª•ng</strong> (Availability), <strong>Hi·ªáu su·∫•t</strong> (Efficiency) v√† <strong>T√¨nh m·ªü r·ªông v√† kh·∫£ nƒÉng b·∫£o tr√¨</strong> (Manageability).</p>
<h3 id="1-kh·∫£-nƒÉng-m·ªü-r·ªông-scalability">1. Kh·∫£ nƒÉng m·ªü r·ªông (Scalability)</h3>
<p>Scalability l√† kh·∫£ nƒÉng m·ªü r·ªông (scaling) c·ªßa h·ªá th·ªëng (system), quy tr√¨nh (process) hay m·∫°ng l∆∞·ªõi (network), v·ªõi nhu c·∫ßu gia tƒÉng v·ªÅ s·ªë l∆∞·ª£ng c√¥ng vi·ªác tƒÉng theo th·ªùi gian c·ªßa m√¥ h√¨nh kinh doanh (business model).</p>
<p>M√¥ h√¨nh kinh doanh c√≥ th·ªÉ m·ªü r·ªông quy m√¥ v√¨ nhi·ªÅu l√Ω do nh∆∞ gia tƒÉng kh·ªëi l∆∞·ª£ng d·ªØ li·ªáu l∆∞u tr·ªØ (data storage) hay kh·ªëi l∆∞·ª£ng c√¥ng vi·ªác (process/request) , v√≠ d·ª•: s·ªë l∆∞·ª£ng truy c·∫≠p hay ƒë·∫∑t h√†ng c·ªßa m·ªôt h·ªá th·ªëng th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠. V√† y√™u c·∫ßu c·ªßa s·ª± m·ªü r·ªông ph·∫£i ƒë·∫°t ƒë∆∞·ª£c nhu c·∫ßu n√†y m√† kh√¥ng l√†m gi·∫£m hi·ªáu su·∫•t, n√≥i chung Scalability l√† ƒë√°p ·ª©ng ƒë∆∞·ª£c s·ª≠ m·ªü r·ªông hay gi·∫£m theo k√≠ch th∆∞·ªõc c·ªßa h·ªá th·ªëng theo th·ªùi gian.</p>
<p>C√≥ hai d·∫°ng scaling l√† m·ªü r·ªông theo chi·ªÅu d·ªçc (vertical scaling) v√† m·ªü r·ªông theo chi·ªÅu ngang (horizontal scaling).</p>
<ul>
<li>Vertical scaling: l√† c√°ch m·ªü r·ªông server hi·ªán t·∫°i b·∫±ng c√°ch n√¢ng c·∫•p ƒë·ªô m·∫°nh (power) b·∫±ng c√°ch n√¢ng c·∫•p CPU, Ram, Storage, v.V‚Ä¶ Vertical-scaling th∆∞·ªùng b·ªã gi·ªõi h·∫°n b·ªüi v∆∞·ª£t qu√° kh·∫£ nƒÉng v·ªÅ c·∫•u h√¨nh v·∫≠t l√Ω hi·ªán ƒë·∫°i hay ƒë·ªô tr·ªÖ khi ‚Äúch·∫≥ng may‚Äù Server b·ªã downtime ƒë·ªÉ n√¢ng c·∫•p hay deploy h·ªá th·ªëng.</li>
<li>Horizontal scaling: l√† c√°ch m·ªü r·ªông b·∫±ng c√°ch th√™m nhi·ªÅu Node/Server v√†o m·ªôt m·∫°ng l∆∞·ªõi ƒëang c√≥, l√†m tƒÉng kh·∫£ nƒÉng ch·ªãu t·∫£i c√≥ h·ªá th·ªëng. C√°ch l√†m n√†y r·∫ª v√† d·ªÖ l√†m h∆°n so v·ªõi Vertical-scaling, ƒë·∫∑c bi·ªát l√† r·∫•t d·ªÖ d√†ng downsize c≈©ng nh∆∞ upsize h·ªá th·ªëng
<img src="/p/system-design-basic/scaling.png"
	width="794"
	height="464"
	srcset="/p/system-design-basic/scaling_hu4f58f2129d86d1fd6c79e75caa3aea3a_39150_480x0_resize_box_3.png 480w, /p/system-design-basic/scaling_hu4f58f2129d86d1fd6c79e75caa3aea3a_39150_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="scaling"
	
	
		class="gallery-image" 
		data-flex-grow="171"
		data-flex-basis="410px"
	
>
M·ªôt v√≠ d·ª• c·ªßa Horizontal-scaling l√† MongoDB v√† Cassandra, c·∫£ hai ƒë·ªÅu cung c·∫•p s·∫µn nh·ªØng ph∆∞∆°ng ph√°p ƒë·ªÉ scale h·ªá th·ªëng b·∫±ng c√°ch th√™m nhi·ªÅu node v√†o ho·∫∑c x√≥a b·ªõt c√°c node m√† kh√¥ng h·ªÅ c√≥ ƒë·ªô tr·ªÖ (zero downtime). V√† m·ªôt v√≠ d·ª• kh√°c v·ªÅ Vertical-scaling l√† MySQL, n√≥ c√≥ th·ªÉ d·ªÖ d√†ng chuy·ªÉn ƒë·ªïi m·ªôt Server ƒëang ch·∫°y sang m·ªôt Server m·ªõi l·ªõn h∆°n kh·ªèe h∆°n, nh∆∞ng qu√° tr√¨nh c√≥ downtime.</li>
</ul>
<h3 id="2-ƒë·ªô-tin-c·∫≠y-reliability">2. ƒê·ªô tin c·∫≠y (Reliability)</h3>
<p>Reliability c√≥ th·ªÉ gi·∫£i th√≠ch d√¢n d√£ r·∫±ng ƒë√≥ l√† ƒë·ªô ‚Äúl√¨‚Äù üí™ c·ªßa h·ªá th·ªëng c√≥ nghƒ©a l√† h·ªá th·ªëng s·∫Ω ti·∫øp t·ª•c cung c·∫•p d·ªãch v·ª• c·ªßa m√¨nh ngay khi c√≥ m·ªôt ho·∫∑c nhi·ªÅu th√†nh ph·∫ßn (ph·∫ßn m·ªÅm/ph·∫ßn c·ª©ng) c·ªßa h·ªá th·ªëng b·ªã l·ªói. Reliability l√† th√†nh ph·∫ßn ch√≠nh trong b·∫•t c·ª© m·ªôt h·ªá th·ªëng ph√¢n t√°n (distributed system) n√†o, b·ªüi v√¨ trong m·ªôt h·ªá th·ªëng nh∆∞ v·∫≠y, m·ªçi h·ªèng h√≥c c·ªßa m·ªôt th√†nh ph·∫ßn n√†o ƒë√≥ s·∫Ω ƒë∆∞·ª£c thay th·∫ø m·ªôt th√†nh ph·∫ßn ƒëang kh·ªèe m·∫°nh kh√°c, ƒë·∫£m b·∫£o lu√¥n ho√†n th√†nh nhi·ªám v·ª• y√™u c·∫ßu.</p>
<p>V√≠ d·ª• c·ªßa ƒë·ªô tin c·∫≠y l√†, m·ªôt trang th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠ hay h·ªá th·ªëng ng√¢n h√†ng (banking) m·ªçi th√¥ng tin v·ªÅ giao d·ªãch (transaction) c·ªßa ng∆∞·ªùi d√πng s·∫Ω kh√¥ng bao gi·ªù b·ªã h·ªßy do l·ªói server ƒëang ch·∫°y giao d·ªãch ƒë√≥, m·ªói server b·ªã l·ªói s·∫Ω ph·∫£i ƒë∆∞·ª£c thay th·∫ø ngay b·ªüi m·ªôt b·∫£n sao ch·ª©a ƒë·∫ßy ƒë·ªß th√¥ng tin c·ªßa server ƒë√≥.</p>
<p>ƒê·ªÉ ƒë·∫°t ƒë∆∞·ª£c ƒë·ªô tin c·∫≠y, h·ªá th·ªëng ph·∫£i c√≥ ch·∫ø ƒë·ªô back-up real time c·ªßa t·ª´ng th√†nh ph·∫ßn trong h·ªá th·ªëng, ƒë√¢y c≈©ng l√† m·ªôt th√°ch th·ª©c v·ªÅ m·∫∑t k·ªπ thu·∫≠t c≈©ng nh∆∞ chi ph√≠ c·ªßa d·ª± √°n.</p>
<h3 id="3-t√≠nh-s·∫µn-s√†ng-availability">3. T√≠nh s·∫µn s√†ng (Availability)</h3>
<p>T√≠nh s·∫µn s√†ng l√† th·ªùi gian m·ªôt h·ªá th·ªëng v·∫´n ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng trong m·ªôt kho·∫£ng th·ªùi gian c·ª• th·ªÉ, ƒë√¢y l√† th∆∞·ªõc ƒëo ƒë∆°n gi·∫£n v·ªÅ t·ª∑ l·ªá ph·∫ßn trƒÉm th·ªùi gian m√† h·ªá th·ªëng ho·∫°t ƒë·ªông li√™n t·ª•c trong m·ªôt kho·∫£ng th·ªùi gian b√¨nh th∆∞·ªùng. V√≠ d·ª• nh∆∞ m·ªôt chi·∫øc xe h∆°i c√≥ th·ªÉ ch·∫°y trong nhi·ªÅu th√°ng m√† kh√¥ng c·∫ßn b·∫£o tr√¨ b·∫£o d∆∞·ª°ng, th√¨ c√≥ th·ªÉ n√≥i l√† chi·∫øc xe ƒë√≥ c√≥ t√≠nh availability cao. N·∫øu chi·∫øc xe h∆°i ƒë√≥ ng·ª´ng ho·∫°t ƒë·ªông ƒë·ªÉ ƒëem t·ªõi gara ƒë·ªÉ b·∫£o tr√¨, n√≥ ƒë∆∞·ª£c coi l√† kh√¥ng availability trong th·ªùi gian ƒë√≥.</p>
<p>S·ª± kh√°c nhau c·ªßa ƒë·ªô tin c·∫≠y (reliability) v√† t√≠nh s·∫µn s√†ng (availability):
N·∫øu h·ªá th·ªëng c√≥ t√≠nh reliability th√¨ n√≥ ch·∫Øc ch·∫Øn s·∫Ω c√≥ availability, tuy nhi√™n h·ªá th·ªëng c√≥ t√≠nh availability kh√¥ng c√≥ nghƒ©a l√† n√≥ c√≥ t√≠nh reliability. N√≥i m·ªôt c√°ch kh√°c th√¨ reliability c√≥ nghƒ©a l√† n√≥ c√≥ t√≠nh high availability, tuy nhi√™n v·∫´n c√≥ th·ªÉ ƒë·∫°t ƒë∆∞·ª£c t√≠nh availability v·ªõi m·ªôt h·ªá th·ªëng kh√¥ng c√≥ t√≠nh reliability b·∫±ng c√°ch gi·∫£m thi·ªÉu t·ªëi ƒëa th·ªùi gian b·∫£o tr√¨, s·ª≠a ch·ªØa. H√£y l·∫•y m·ªôt v√≠ d·ª•, m·ªôt h·ªá th·ªëng eCommerce c√≥ t·ª∑ l·ªá availability l√™n ƒë·∫øn 99,99% trong hai nƒÉm ƒë·∫ßu ti√™n n√≥ b·∫Øt ƒë·∫ßu, nh∆∞ng h·ªá th·ªëng c√≥ m·ªôt l·ªói ti·ªÅm ·∫©n v·ªÅ b·∫£o m·∫≠t m√† trong qu√° tr√¨nh ki·ªÉm th·ª≠ (testing) kh√¥ng ph√°t hi·ªán ra, kh√°ch h√†ng kh√¥ng h·ªÅ bi·∫øt v·ªÅ ƒëi·ªÅu ƒë√≥ v√† h·ªç v·∫´n r·∫•t h·∫°nh ph√∫c (happy) v·ªõi h·ªá th·ªëng, cho ƒë·∫øn m·ªôt ng√†y ƒë·∫πp tr·ªùi v√†o b·ªóng nhi√™n l·ªói ti·ªÅm ·∫©n ƒë√≥ b·ªã khai th√°c d·∫´n ƒë·∫øn h·ªá th·ªëng gi·∫£m t√≠nh s·∫µn s√†ng trong m·ªôt th·ªùi gian d√†i h∆°n b√¨nh th∆∞·ªùng cho ƒë·∫øn khi l·ªói ƒë∆∞·ª£c ‚Äúhot fix‚Äù ngay l·∫≠p t·ª©c.</p>
<p>K·ª≥ th·ª±c m√† n√≥i m·ªôt h·ªá th·ªëng c√≥ ƒë·ªô tin c·∫≠y cao (high reliability) g·∫ßn nh∆∞ r·∫•t kh√≥ ƒë·∫°t ƒë∆∞·ª£c trong th·ª±c t·∫ø, m√† h·∫ßu nh∆∞ ch√∫ng ta ch·ªâ h∆∞·ªõng t·ªõi m·ªôt h·ªá th·ªëng c√≥ t√≠nh s·∫µn s√†ng cao (high availability) m√† th√¥i.</p>
<h3 id="4-hi·ªáu-su·∫•t-efficiency">4. Hi·ªáu su·∫•t (Efficiency)</h3>
<p>Hi·ªáu su·∫•t c·ªßa m·ªôt h·ªá th·ªëng ph√¢n t√°n l√† kh·∫£ nƒÉng ch·ªãu t·∫£i (high load) v√† th·ªùi gian ph·∫£n h·ªìi (low latency). C√≥ nghƒ©a l√† m·ªôt h·ªá th·ªëng c√≥ kh·∫£ nƒÉng ch·ªãu ƒë∆∞·ª£c nhi·ªÅu request ƒë·ªìng th·ªùi v·ªõi ƒë·ªô tr·ªÖ th·∫•p l√† m·ªôt h·ªá th·ªëng c√≥ hi·ªáu su·∫•t cao. Th√¥ng th∆∞·ªùng n√≥ ƒë∆∞·ª£c ƒëo ƒë·∫øm b·∫±ng s·ªë l∆∞·ª£ng request n√≥ nh·∫≠n ƒë∆∞·ª£c v√† ph·∫£n h·ªìi trong m·ªôt kho·∫£ng th·ªùi gian, th∆∞·ªùng ƒë∆∞·ª£c t√≠nh b·∫±ng gi√¢y. V√≠ d·ª• m·ªôt h·ªá th·ªëng eCommerce c√≥ hi·ªáu su·∫•t l√† ch·ªãu ƒë∆∞·ª£c 5k l∆∞·ª£t ƒë·∫∑t h√†ng tr√™n m·ªôt gi√¢y ‚Äî 5k order / second, hay 500k l∆∞·ª£t ng∆∞·ªùi c√πng truy c·∫≠p v√†o c√πng m·ªôt th·ªùi ƒëi·ªÉm.</p>
<h3 id="5-t√≠nh-m·ªü-r·ªông-v√†-kh·∫£-nƒÉng-b·∫£o-tr√¨-manageability">5. T√≠nh m·ªü r·ªông v√† kh·∫£ nƒÉng b·∫£o tr√¨ (Manageability)</h3>
<p>M·ªôt t√≠nh ch·∫•t quan tr·ªçng kh√°c c·ªßa m·ªôt distributed system ƒë√≥ l√† kh·∫£ nƒÉng d·ªÖ d√†ng m·ªü r·ªông v√† b·∫£o tr√¨ c·ªßa h·ªá th·ªëng, n√≥i c√°ch kh√°c l√† t·ªëc ƒë·ªô c·ªßa h·ªá th·ªëng khi th·ª±c hi·ªán <strong>s·ª≠a ch·ªØa (repair)</strong> hay <strong>b·∫£o tr√¨ (maintain)</strong> khi c·∫ßn, n·∫øu th·ªùi gian tr√™n c√†ng cao th√¨ t√≠nh availability c√†ng th·∫•p. ƒê·ªÉ ƒë·∫°t ƒë∆∞·ª£c ƒëi·ªÅu n√†y, h·ªá th·ªëng c·∫ßn ph·∫£i d·ªÖ d√†ng ph√°t hi·ªán l·ªói ho·∫∑c l·ªói ti·ªÅm t√†ng n·∫øu c√≥, kh·∫£ nƒÉng hi·ªÉu nhanh ƒë∆∞·ª£c nguy√™n nh√¢n l·ªói (root cause), d·ªÖ d√†ng th·ª±c hi·ªán c√°c thay ƒë·ªïi c·∫ßn thi·∫øt ƒë·ªÉ ƒëi·ªÅu ch·ªânh, ho·∫∑c ƒë∆°n gi·∫£n ch·ªâ l√† d·ªÖ d√†ng m·ªü r·ªông khi c·∫ßn.</p>
<p>Vi·ªác s·ªõm ph√°t hi·ªán c≈©ng nh∆∞ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ s·ªõm s·∫Ω l√†m gi·∫£m downtime t·ª´ ƒë√≥ tƒÉng t√≠nh s·∫µn s√†ng c·ªßa h·ªá th·ªëng ƒëi l√™n. V√≠ d·ª• nh·ªØng ·ª©ng d·ª•ng doanh nghi·ªáp (enterprise system) c√≥ kh·∫£ nƒÉng t·ª± ph√°t hi·ªán l·ªói sau ƒë√≥ c√¥ l·∫≠p v√† b√°o c√°o nhanh cho ng∆∞·ªùi v·∫≠n h√†nh h·ªá th·ªëng.</p>
<h2 id="ph·∫ßn-2-c√¢n-b·∫±ng-t·∫£i-load-balancing">Ph·∫ßn 2: C√¢n b·∫±ng t·∫£i (Load balancing)</h2>
<p>C√¢n b·∫±ng t·∫£i (load balancing ‚Äî LB) l√† m·ªôt th√†nh ph·∫ßn n·ªØa c≈©ng c·ª±c k·ª≥ quan tr·ªçng trong b·∫•t k·ª≥ m·ªôt distributed system n√†o, n√≥ gi√∫p cho h·ªá th·ªëng c√≥ th·ªÉ ph√¢n t·∫£i c√°c request t·ªõi ƒë·ªÅu c√°c Server (Application ho·∫∑c Database), gi√∫p cho h·ªá th·ªëng c√≥ t√≠nh availability h∆°n. LB s·∫Ω li√™n t·ª•c ki·ªÉm tra (health checks) nh·ªØng tr·∫°ng th√°i c·ªßa c√°c server trong h·ªá th·ªëng, n·∫øu tr·∫°ng th√°i c·ªßa server l√† kh·ªèe m·∫°nh (healthy) th√¨ n√≥ s·∫Ω g·ª≠i quest t·ªõi, c√≤n n·∫øu server kh√¥ng available ho·∫∑c kh√¥ng c√≥ response tr·∫£ v·ªÅ (not healthy) th√¨ LB s·∫Ω kh√¥ng g·ª≠i request t·ªõi server ƒë√≥ n·ªØa (ƒë√° ra kh·ªèi LB), v√† cho t·ªõi khi server ƒë√≥ healthy tr·ªü l·∫°i th√¨ LB s·∫Ω th√™m l·∫°i server ƒë√≥ v√†o LB.</p>
<p>C√≥ r·∫•t nhi·ªÅu thu·∫≠t to√°n ƒë·ªÉ LB ƒëi·ªÅu ph·ªëi c√°c request t·ªõi c√°c resource c·ªßa m√¨nh nh∆∞ thu·∫≠t to√°n ƒë∆°n gi·∫£n nh·∫•t l√† thu·∫≠t to√°n ‚ÄúRound Robin‚Äù. L√† thu·∫≠t to√°n lu√¢n chuy·ªÉn v√≤ng, c√°c m√°y ch·ªß s·∫Ω ƒë∆∞·ª£c xem ngang h√†ng v√† s·∫Øp x·∫øp theo m·ªôt v√≤ng quay, c√°c truy v·∫•n d·ªãch v·ª• s·∫Ω l·∫ßn l∆∞·ª£t ƒë∆∞·ª£c g·ª≠i t·ªõi c√°c m√°y ch·ªß theo th·ª© t·ª± s·∫Øp x·∫øp. Ngo√†i ra c√≤n r·∫•t nhi·ªÅu thu·∫≠t to√°n ph·ª©c t·∫°p kh√°c n·ªØa, tuy nhi√™n tr√™n th·ª±c t·∫ø ch∆∞a c√≥ m·ªôt thu·∫≠t to√°n LB n√†o th·ª±c s·ª± ho√†n h·∫£o, n√≥ ch·ªâ m·ªôt ph·∫ßn n√†o t∆∞∆°ng ƒë·ªëi ch·∫•p nh·∫≠n ƒë∆∞·ª£c th√¥i.</p>
<p>B·∫±ng c√°ch c√¢n b·∫±ng t·∫£i c√°c request t·ªõi ·ª©ng d·ª•ng tr√™n nhi·ªÅu server, LB s·∫Ω gi·∫£m t·∫£i cho t·ª´ng server v√† ngƒÉn b·∫•t k·ª≥ m·ªôt m√°y ch·ªß server n√†o tr·ªü th√†nh m·ªôt ƒëi·ªÉm l·ªói duy nh·∫•t (Single point of failure), do ƒë√≥ c·∫£i thi·ªán kh·∫£ nƒÉng ƒë√°p ·ª©ng v√† t√≠nh s·∫µn s√†ng c·ªßa ·ª©ng d·ª•ng. Nh·∫•t l√† khi b·∫°n scaling h·ªá th·ªëng theo chi·ªÅu ngang (horizontal scaling) nh∆∞ ƒë√£ ƒë·ªÅ c·∫≠p ·ªü ph·∫ßn Scalability.
<img src="/p/system-design-basic/lb.png"
	width="1400"
	height="666"
	srcset="/p/system-design-basic/lb_hu9cd9e4347c20c0b3ec8fca3005d12a61_153538_480x0_resize_box_3.png 480w, /p/system-design-basic/lb_hu9cd9e4347c20c0b3ec8fca3005d12a61_153538_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="M√¥ h√¨nh m√¥ t·∫£ m·ªôt h·ªá th·ªëng distributed system ƒë∆∞·ª£c horizontal scaling v√† s·ª≠ d·ª•ng LB ƒë·ªÉ c√¢n b·∫±ng t·∫£i."
	
	
		class="gallery-image" 
		data-flex-grow="210"
		data-flex-basis="504px"
	
>
ƒê·ªÉ h·ªá th·ªëng c√≥ t√≠nh high availability, th√¨ ta c√≥ th·ªÉ √°p d·ª•ng LB nhi·ªÅu l·ªõp (layer) c·ªßa h·ªá th·ªëng nh∆∞ LB cho nhi·ªÅu DB, LB cho Web-Server hay LB cho Application Server, v√≠ d·ª• nh∆∞ m√¥ h√¨nh d∆∞·ªõi.
<img src="/p/system-design-basic/lbm.png"
	width="1400"
	height="320"
	srcset="/p/system-design-basic/lbm_huff6fa6555bcb09ada6be5f8b8f70aa93_94341_480x0_resize_box_3.png 480w, /p/system-design-basic/lbm_huff6fa6555bcb09ada6be5f8b8f70aa93_94341_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="M√¥ h√¨nh Load Balancing nhi·ªÅu t·∫ßng."
	
	
		class="gallery-image" 
		data-flex-grow="437"
		data-flex-basis="1050px"
	
>
Nh·ªØng l·ª£i √≠ch c·ªßa LB:</p>
<ul>
<li>Tr·∫£i nghi·ªám ng∆∞·ªùi c·ªßa ng∆∞·ªùi d√πng s·∫Ω t·ªët h∆°n, v√† kh√¥ng b·ªã gi√°n ƒëo·∫°n b·ªüi b·∫•t k·ª≥ m·ªôt s·ª± c·ªë n√†o x·∫£y ra tr√™n m·ªôt ho·∫∑c v√†i server, ngo√†i ra c≈©ng tƒÉng t·ªëc ƒë·ªô truy v·∫•n c·ªßa ng∆∞·ªùi d√πng nh·ªù nƒÉng l·ª±c c·ªßa nhi·ªÅu server h·ª£p l·∫°i.</li>
<li>LB gi√∫p cho qu·∫£n tr·ªã vi√™n r·∫•t d·ªÖ scale up ho·∫∑c scale down h·ªá th·ªëng m√† kh√¥ng l√†m gi√°n ƒëo·∫°n tr·∫£i nghi·ªám c·ªßa ng∆∞·ªùi d√πng.</li>
<li>M·ªôt LB th√¥ng minh s·∫Ω gi√∫p ng∆∞·ªùi qu·∫£n tr·ªã vi√™n x√°c ƒë·ªãnh ƒë∆∞·ª£c nh·ªØng t·∫Øc ngh·∫Ωn hay qu√° t·∫£i (traffic bottlenecks) tr∆∞·ªõc khi n√≥ x·∫£y ra, ƒë·ªÉ ng∆∞·ªùi qu·∫£n tr·ªã c√≥ th·ªÉ h√†nh ƒë·ªông k·ªãp th·ªùi, nh∆∞ scale up h·ªá th·ªëng.</li>
<li>LB gi√∫p ng∆∞·ªùi qu·∫£n tr·ªã vi√™n (devops/system admin) ƒë·ª° cƒÉng th·∫≥ng h∆°n v√¨ thay v√¨ ch·ªâ m·ªôt Server duy nh·∫•t th·ª±c hi·ªán nhi·ªÅu c√¥ng vi·ªác th√¨ ta s·∫Ω chia nhi·ªÅu c√¥ng vi·ªác nh·ªè h∆°n cho nhi·ªÅu server, t·ª´ ƒë√≥ vi·ªác c·∫£ h·ªá th·ªëng fail s·∫Ω √≠t x·∫£y ra h∆°n.</li>
</ul>
<p>Tuy nhi√™n LB c√≥ th·ªÉ tr·ªü th√†nh m·ªôt single point of failure, n·∫øu n√≥ b·ªã qu√° t·∫£i hay l·ªói ph·∫ßn c·ª©ng/m·ªÅm khi·∫øn LB s·ª•p ƒë·ªï d·∫´n ƒë·∫øn c·∫£ h·ªá th·ªëng s·ª•p ƒë·ªï theo. ƒê·ªÉ kh·∫Øc ph·ª•c ƒëi·ªÅu n√†y t·ªët nh·∫•t hay c√≥ √≠t nh·∫•t 2 LB k·∫øt h·ª£p v·ªõi nhau th√†nh m·ªôt c·ª•m LB ch·∫°y d∆∞·ªõi d·∫°ng active-standby t·ª©c l√† lu√¥n c√≥ m·ªôt LB backup cho m·ªôt LB c√≤n l·∫°i ƒëang ch·∫°y ƒë·ªÉ ph·ª•c v·ª• cho tr∆∞·ªùng h·ª£p LB ch√≠nh b·ªã h·ªèng th√¨ LB c√≤n l·∫°i s·∫Ω ƒë·∫£m nhi·ªám.
<img src="/p/system-design-basic/lbb.png"
	width="1400"
	height="644"
	srcset="/p/system-design-basic/lbb_hu145caef88a6d3991460a0f87df067441_173020_480x0_resize_box_3.png 480w, /p/system-design-basic/lbb_hu145caef88a6d3991460a0f87df067441_173020_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="M√¥ h√¨nh c·ª•m LB backup cho nhau."
	
	
		class="gallery-image" 
		data-flex-grow="217"
		data-flex-basis="521px"
	
></p>
<h2 id="ph·∫ßn-3-b·ªô-ƒë·ªám--caching">Ph·∫ßn 3: B·ªô ƒë·ªám ‚Äî Caching</h2>
<p>Load balancing gi√∫p h·ªá th·ªëng m·ªü r·ªông theo chi·ªÅu ngang b·∫±ng c√°ch ng√†y c√†ng tƒÉng s·ªë l∆∞·ª£ng c√°c m√°y ch·ªß, nh∆∞ng Caching l·∫°i l√† c√°ch ƒë·ªÉ s·ª≠ d·ª•ng t√†i nguy√™n (resource) hi·ªáu qu·∫£ h∆°n t·ª´ ƒë√≥ resource c·∫ßn cung c·∫•p gi·∫£m ƒëi, nh·∫±m ti·∫øt ki·ªám resource v√† gi·∫£m chi ph√≠ c·ªßa h·ªá th·ªëng.</p>
<p>ƒê·ªÉ l√†m ƒë∆∞·ª£c ƒëi·ªÅu n√†y, h·ªá th·ªëng s·∫Ω cung c·∫•p m·ªôt v√πng nh·ªõ ƒë·ªám (cache) ƒë·ªÉ ch·ª©a nh·ªØng d·ªØ li·ªáu ƒë∆∞·ª£c request nhi·ªÅu l·∫ßn m√† kh√¥ng th∆∞·ªùng xuy√™n thay ƒë·ªïi v√†o ƒë√≥, t·ª´ ƒë√≥ h·ªá th·ªëng s·∫Ω l·∫•y d·ªØ li·ªáu t·ª´ b·ªô nh·ªõ cache m√† kh√¥ng truy c·∫≠p v√†o b·ªô nh·ªõ ch√≠nh. ƒêi·ªÅu n√†y gi√∫p b·ªô nh·ªõ ch√≠nh s·∫Ω ƒë∆∞·ª£c gi·∫£m t·∫£i ƒëi t·ª´ ƒë√≥ nƒÉng l·ª±c c·ªßa n√≥ tƒÉng l√™n.</p>
<p>B·ªô nh·ªõ cache ƒë∆∞·ª£c s·ª≠ d·ª•ng r·∫•t r·ªông r√£i trong m·ªçi th√†nh ph·∫ßn c·ªßa h·ªá th·ªëng nh∆∞ trong ph·∫ßn c·ª©ng (hardware) nh∆∞ RAM/CPU Cache, h·ªá ƒëi·ªÅu h√†nh (operating systems), tr√¨nh duy·ªát web (web browsers), web applications v.v‚Ä¶ B·ªô nh·ªõ cache gi·ªëng nh∆∞ m·ªôt b·ªô nh·ªõ ng·∫Øn h·∫°n (short- term memory) n√≥ c√≥ gi·ªõi h·∫°n v·ªÅ k√≠ch c·ª°, nh∆∞ng th∆∞·ªùng nhanh h∆°n r·∫•t nhi·ªÅu l·∫ßn b·ªô nh·ªõ ch√≠nh</p>
<p>V·ªÅ ki·∫øn tr√∫c ph·∫ßn m·ªÅm th√¨ Cache c√≥ th·ªÉ t·ªìn t·∫°i ·ªü h·∫ßu h·∫øt c√°c th√†nh ph·∫ßn, nh∆∞ng ch·ªß y·∫øu n√≥ t·ªìn t·∫°i ·ªü ph·∫ßn thao t√°c v·ªõi d·ªØ li·ªáu nh∆∞ Database Layer, gi√∫p tr·∫£ v·ªÅ d·ªØ li·ªáu nhanh h∆°n m√† kh√¥ng c·∫ßn t·ªën chi ph√≠ ƒë·ªÉ truy c·∫≠p v√†o Database, hay ·ªü ph·∫ßn Front-end ƒë·ªÉ Cache nh·ªØng resource tƒ©nh nh∆∞ js, css, image file b·∫±ng c√°ch d√πng CDN.</p>
<h3 id="b·ªô-ƒë·ªám-t·∫ßng-backendapplication-server-cache">B·ªô ƒë·ªám t·∫ßng Backend(Application Server Cache)</h3>
<p>·ªû t·∫ßng backend Cache ƒë∆∞·ª£c √°p d·ª•ng nh∆∞ m·ªôt b·∫£n sao ho·∫∑c m·ªôt ph·∫ßn c·ªßa DB/Storage, m·ªói l·∫ßn ·ª©ng d·ª•ng request d·ªØ li·ªáu t·ª´ DB/Storage n√≥ s·∫Ω t√¨m trong b·ªô nh·ªõ Cache, n·∫øu c√≥ ·ª©ng s·∫Ω tr·∫£ v·ªÅ d·ªØ li·ªáu t·ª©c th√¨ m√† kh√¥ng t·ªën t√†i nguy√™n ƒë·ªÉ query xu·ªëng DB/Storage. Tuy nhi√™n n√≥ ch·ªâ c√≥ t√°c d·ª•ng v·ªõi nh·ªØng d·ªØ li·ªáu ƒë∆∞·ª£c truy c·∫≠p nhi·ªÅu l·∫ßn nh∆∞ng √≠t ƒë∆∞·ª£c thay ƒë·ªïi, v√≠ d·ª• th√¥ng tin c√° nh√¢n c·ªßa ng∆∞·ªùi d√πng (t√™n, qu√™ qu√°n/qu·ªëc t·ªãch, ng√†y th√°ng nƒÉm sinh, ƒë·ªãa ch·ªâ, s·ªë ƒëi·ªán tho·∫°i‚Ä¶).
N·∫øu ta c√≥ nhu c·∫ßu gia tƒÉng kh·∫£ nƒÉng ch·ªãu t·∫£i b·ªô nh·ªõ Cache theo m√¥ h√¨nh horizontal scaling, khi ƒë√≥ ta s·∫Ω c√≥ th√™m nhi·ªÅu node v√† m·ªói node s·∫Ω ch·ª©a c√°c d·ªØ li·ªáu c·ªßa ri√™ng n√≥. Tuy nhi√™n ƒëi·ªÅu n√†y s·∫Ω d·∫´n ƒë·∫øn s·ªë l∆∞·ª£ng ‚Äúcache miss‚Äù tƒÉng cao v√¨ LB s·∫Ω t√πy ch·ªçn ng·∫´u nhi√™n 1 node m·ªói request t·ª´ ƒë√≥ m·ªôt request s·∫Ω t·ªõi nhi·ªÅu ‚Äúcache node‚Äù kh√°c nhau. V√† ƒë·ªÉ gi·∫£i quy·∫øt ƒëi·ªÅu n√†y ta c√≥ hai s·ª± l·ª±a ch·ªçn l√† s·ª≠ d·ª•ng duy nh·∫•t m·ªôt nh·ªõ Cache l·ªõn, ho·∫∑c ph√¢n chia d·ªØ li·ªáu cache tr√™n c·ª•m server v·ªõi Consistent Hashing</p>
<h3 id="b·ªô-ƒë·ªám-t·∫ßng-frontend--content-distribution-network-cdn">B·ªô ƒë·ªám t·∫ßng Frontend ‚Äî Content Distribution Network (CDN)</h3>
<p>CDN ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ caching nh·ªØng resource tƒ©nh tr√™n c√°c website nh∆∞ js, css, images‚Ä¶ (static media) m·∫°ng l∆∞·ªõi CDN s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t ·ªü nhi·ªÅu v√πng ƒë·ªãa l√Ω kh√°c nhau v√† d·ª±a theo ƒë·ªãa ch·ªâ c·ªßa t·ª´ng request m√† c√°c static media s·∫Ω ƒë∆∞·ª£c tr·∫£ v·ªÅ t·ª´ tr√™n c√°c m√°y ch·ªß CDN ·ªü g·∫ßn n√≥ nh·∫•t, n·∫øu kh√¥ng c√≥ tr√™n t·∫•t c·∫£ c√°c m√°y ch·ªß CDN th√¨ n√≥ s·∫Ω l·∫•y d·ªØ li·ªáu ƒë√≥ t·ª´ Back-end Server ƒë·ªÉ tr·∫£ v·ªÅ v√† ƒë·ªìng th·ªùi cached d·ªØ li·ªáu v·ª´a l·∫•y l√™n CDN. Nh·ªù v·∫≠y ta c√≥ th·ªÉ tƒÉng t·ªëc kh·∫£ nƒÉng ch·ªãu t·∫£i c≈©ng nh∆∞ t·ªëc ƒë·ªô c·ªßa website.
N·∫øu h·ªá th·ªëng c·ªßa b·∫°n kh√¥ng ƒë·ªß l·ªõn ƒë·ªÉ x√¢y d·ª±ng m·ªôt CDN ri√™ng c·ªßa m√¨nh th√¨ b·∫°n c≈©ng c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c d·ªãch v·ª• CDN s·∫µn c√≥ nh∆∞ nh∆∞ Cloudflare, BootstrapCDN hay Amazon CloudFront v.v‚Ä¶</p>
<h3 id="cache-invalidation">Cache Invalidation</h3>
<p>V·ªÅ b·∫£n ch·∫•t Cache l√† m·ªôt b·∫£n sao c·ªßa b·ªô nh·ªõ ch√≠nh c√≥ th·ªÉ l√† DB hay c√°c d·∫°ng Storage kh√°c, v√≠ d·ª• d·ªØ li·ªáu t·ª´ DB ƒë∆∞·ª£c update, th√¨ cache ph·∫£i ƒë∆∞·ª£c update theo (invalidated cache).Cho n√™n vi·ªác ƒë·ªìng b·ªô d·ªØ li·ªáu gi·ªØa b·ªô nh·ªõ ch√≠nh v√† Cache ƒë·ªÉ gi·∫£i quy·∫øt t√≠nh consistency c·ªßa h·ªá th·ªëng l√† m·ªôt v·∫•n ƒë·ªÅ ph·∫£i gi·∫£i quy·∫øt.</p>
<p>Ta c√≥ 3 chi·∫øn thu·∫≠t ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ v·ªÅ cache invalidation l√†:</p>
<ol>
<li>Write-through cache
L√† chi·∫øn thu·∫≠t khi c√≥ d·ªØ li·ªáu c·∫ßn thay ƒë·ªïi, h·ªá th·ªëng s·∫Ω ghi d·ªØ li·ªáu c·∫£ v√† Cache ho·∫∑c DB ƒë·ªìng th·ªùi. Vi·ªác n√†y s·∫Ω ƒë·∫£m b·∫£o ƒë∆∞·ª£c vi·ªác d·ªØ li·ªáu s·∫Ω lu√¥n lu√¥n consistency b·ªüi v√¨ process s·∫Ω kh√¥ng th√†nh c√¥ng v√† ph·∫£i th·ª±c hi·ªán l·∫°i n·∫øu m·ªôt trong hai thao t√°c ghi v√†o Cache ho·∫∑c ghi v√†o DB b·ªã l·ªói. Tuy nhi√™n ƒëi·ªÉm y·∫øu c·ªßa chi·∫øn thu·∫≠t n√†y l√† ƒë·ªô tr·ªÖ cao trong vi·ªác ghi d·ªØ li·ªáu, v√¨ ƒë√≤i h·ªèi c·∫£ hai thao t√°c ghi t·ª´ DB v√† Cache ph·∫£i ƒë∆∞·ª£c ho√†n th√†nh.</li>
<li>Write-around cache
Chi·∫øn thu·∫≠t n√†y khi c√≥ d·ªØ li·ªáu c·∫ßn thay ƒë·ªïi, s·∫Ω ch·ªâ ghi v√†o DB m√† b·ªè qua Cache. ƒêi·ªÅu n√†y s·∫Ω c√≥ th·ªÉ gi·∫£m vi·ªác Cache b·ªã tr√†n ng·∫≠p c√°c thao t√°c ghi m√† r·∫•t c√≥ th·ªÉ c√°c d·ªØ li·ªáu n√†y s·∫Ω kh√¥ng bao gi·ªù ƒë∆∞·ª£c s·ª≠ d·ª•ng. Tuy nhi√™n vi·ªác n√†y s·∫Ω g√¢y ra tr∆∞·ªùng h·ª£p ‚Äúcache miss‚Äù n·∫øu client g·ª≠i m·ªôt request ƒë∆∞·ª£c t·ª´ m·ªôt b·∫£n ghi m·ªõi ƒë∆∞·ª£c ghi v√†o, n√≥ s·∫Ω g√¢y ƒë·ªô tr·ªÖ khi ƒë·ªçc v√¨ l√∫c n√†y d·ªØ li·ªáu ph·∫£i ƒë·ªçc t·ª´ DB sau ƒë√≥ m·ªõi ƒë∆∞·ª£c ghi ng∆∞·ª£c l·∫°i v√†o Cache v√† tr·∫£ v·ªÅ cho Client. V√† chi·∫øn thu·∫≠t n√†y ch·ªâ ph√π h·ª£p v·ªõi nh·ªØng d·ªØ li·ªáu √≠t thay ƒë·ªïi v√† h·ªá th·ªëng ch·∫•p nh·∫≠n ƒë·ªô tr·ªÖ c·ªßa d·ªØ li·ªáu, v√¨ d·ªØ li·ªáu c√≥ th·ªÉ kh√¥ng consistency trong l√∫c Cache ch∆∞a h·∫øt h·∫°n (expired) m√† c√≥ d·ªØ li·ªáu m·ªõi ƒë√£ ƒë∆∞·ª£c update.</li>
<li>Write-back cache
L√† khi c√≥ d·ªØ li·ªáu c·∫ßn thay ƒë·ªïi, s·∫Ω ch·ªâ ghi v√†o b·ªô nh·ªõ Cache m√† b·ªè qua DB, d·ªØ li·ªáu ch·ªâ ghi v√†o DB sau m·ªôt kho·∫£ng th·ªùi gian (interval) ho·∫∑c v·ªõi ƒëi·ªÅu ki·ªán n√†o ƒë√≥. ƒêi·ªÅu n√†y s·∫Ω c√≥ l·ª£i √≠ch t·∫°o ra cho h·ªá th·ªëng ƒë·ªô tr·ªÖ th·∫•p (low latency) v√† l∆∞u l∆∞·ª£ng cao (high throughput) v·ªõi nh·ªØng h·ªá th·ªëng chuy√™n ghi (write-intensive). Tuy nhi√™n chi·∫øn thu·∫≠t n√†y c√≥ ƒë·ªô r·ªßi ro cao v·ªÅ m·∫•t m√°t d·ªØ li·ªáu, b·ªüi v√¨ tr∆∞·ªõc khi d·ªØ li·ªáu ƒë∆∞·ª£c ghi v√†o DB th√¨ d·ªØ li·ªáu c·ªßa ch√∫ng ta ch·ªâ n·∫±m ·ªü trong Cache, b·∫•t k·ª≥ m·ªôt s·ª± c·ªë n√†o v·ªÅ Cache ƒë·ªÅu c√≥ th·ªÉ g√¢y m·∫•t m√°t d·ªØ li·ªáu.</li>
</ol>
<h3 id="cache-eviction-policies">Cache eviction policies</h3>
<p>Ngo√†i ra ta c≈©ng c√≥ c√°c c√°ch chi·∫øn thu·∫≠t x√≥a d·ªØ li·ªáu kh√¥ng c√≤n c·∫ßn thi·∫øt t·ª´ Cache.</p>
<ol>
<li>First In First Out (FIFO): C√°ch d·ªØ li·ªáu ƒë∆∞·ª£c ghi v√†o Cache tr∆∞·ªõc th√¨ s·∫Ω ƒë∆∞·ª£c ∆∞u ti√™n x√≥a ƒëi tr∆∞·ªõc m√† kh√¥ng quan t√¢m t·ªõi t·∫ßn su·∫•t hay s·ªë l∆∞·ª£ng truy c·∫≠p c·ªßa n√≥.</li>
<li>Last In First Out (LIFO): S·∫Ω ∆∞u ti√™n x√≥a nh·ªØng d·ªØ li·ªáu ƒë∆∞·ª£c ghi c≈© nh·∫•t m√† kh√¥ng quan t√¢m t·ªõi t·∫ßn su·∫•t hay s·ªë l∆∞·ª£ng truy c·∫≠p c·ªßa n√≥.</li>
<li>Least Recently Used (LRU): S·∫Ω x√≥a nh·ªØng d·ªØ li·ªáu √≠t ƒë∆∞·ª£c truy c·∫≠p g·∫ßn ƒë√¢y tr∆∞·ªõc ti√™n.</li>
<li>Most Recently Used (MRU): S·∫Ω x√≥a nh·ªØng d·ªØ li·ªáu ƒë∆∞·ª£c truy c·∫≠p th∆∞·ªùng xuy√™n g·∫ßn ƒë√¢y nh·∫•t.</li>
<li>Least Frequently Used (LFU): S·∫Ω x√≥a nh·ªØng d·ªØ li·ªáu √≠t ƒë∆∞·ª£c truy c·∫≠p nh·∫•t.</li>
<li>RR: S·∫Ω tr·ªçn ra m·ªôt d·ªØ li·ªáu b·∫•t k·ª≥ tr√™n Cache ƒë·ªÉ th·ª±c hi·ªán thao t√°c x√≥a.</li>
</ol>
<p>Th√¥ng th∆∞·ªùng th√¨ h·ªá th·ªëng s·∫Ω ƒë√°nh d·∫•u th·ªùi ƒëi·ªÉm h·∫øt h·∫°n (expire time) c·ªßa d·ªØ li·ªáu, n·∫øu qu√° th·ªùi h·∫°n th√¨ Cache s·∫Ω b·ªã x√≥a ƒëi. T√≠nh to√°n expire time c·ªßa Cache c≈©ng l√† m·ªôt b√†i to√°n kh√° ƒëau ƒë·∫ßu t√πy v√†o logic c·ªßa h·ªá th·ªëng ƒëang ph√°t tri·ªÉn.</p>
<h2 id="ph·∫ßn-4-ph√¢n-chia-d·ªØ-li·ªáu--shardingdata-partitioning">Ph·∫ßn 4: Ph√¢n chia d·ªØ li·ªáu ‚Äî Sharding/Data Partitioning</h2>
<p>Ph√¢n chia d·ªØ li·ªáu (Sharding) l√† m·ªôt gi·∫£i ph√°p chia nh·ªè m·ªôt Database l·ªõn th√†nh nhi·ªÅu Database nh·ªè, ta c√≥ th·ªÉ ph√¢n t√°ch t·ª´ng b·∫£ng ho·∫∑c c·∫£ m·ªôt DB ra nhi·ªÅu ph·∫ßn nh·ªè ƒë·∫∑t ·ªü nhi·ªÅu m√°y ch·ªß (server) kh√°c nhau. ƒêi·ªÅu n√†y s·∫Ω gi√∫p cho h·ªá th·ªëng DB c·ªßa ch√∫ng ta ƒë·∫°t ƒë∆∞·ª£c c√°c t√≠nh ch·∫•t kh·∫£ nƒÉng b·∫£o tr√¨ (manageability), hi·ªáu xu·∫•t (performance), t√≠nh s·∫µn s√†ng (availability), v√† c√¢n b·∫±ng t·∫£i (load balancing) c·ªßa ·ª©ng d·ª•ng. V√† gi·∫£i ph√°p n√†y c≈©ng gi·∫£m chi ph√≠ c≈©ng nh∆∞ t√≠nh m·ªü r·ªông (scalability) ƒë·ªÉ scale up DB b·∫±ng c√°ch d√πng nhi·ªÅu server nh·ªè g·ªôp l·∫°i h∆°n l√† n√¢ng c·∫•p m·ªôt server l·ªõn.
<img src="/p/system-design-basic/ds1.png"
	width="401"
	height="188"
	srcset="/p/system-design-basic/ds1_hu609feb72800955956481269af14dd6c4_10013_480x0_resize_box_3.png 480w, /p/system-design-basic/ds1_hu609feb72800955956481269af14dd6c4_10013_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="m√¥ h√¨nh"
	
	
		class="gallery-image" 
		data-flex-grow="213"
		data-flex-basis="511px"
	
></p>
<h3 id="nh·ªØng-c√°ch-th·ª©c-ph√¢n-chia-d·ªØ-li·ªáu">Nh·ªØng c√°ch th·ª©c ph√¢n chia d·ªØ li·ªáu</h3>
<p>Ta c√≥ 3 c√°ch th·ª©c Sharding d·ªØ li·ªáu nh∆∞ sau:</p>
<ol>
<li>Horizontal sharding
L√† c√°ch chia c√πng d·ªØ li·ªáu c·ªßa c√πng m·ªôt b·∫£ng (table) ra nhi·ªÅu DB kh√°c nhau. V√≠ d·ª• ta c√≥ b·∫£ng d·ªØ li·ªáu th√¥ng tin v·ªÅ ng∆∞·ªùi d√πng, ta s·∫Ω d·ª±a tr√™n location c·ªßa ng∆∞·ªùi d√πng ƒë·ªÉ quy·∫øt ƒë·ªãnh n√≥ n·∫±m ·ªü DB n√†o, v√≠ d·ª• ng∆∞·ªùi d√πng ·ªü S√†i G√≤n th√¨ s·∫Ω ch·ª© ·ªü DB_SG, th√¥ng tin ng∆∞·ªùi d√πng ·ªü Bi√™n H√≤a s·∫Ω n·∫±m ·ªü DB_BH hay th√¥ng tin ng∆∞·ªùi d√πng ·ªü Vƒ©nh Long s·∫Ω n·∫±m ·ªü DB_VL.
Gi·∫£i ph√°p n√†y c√≥ m·ªôt v·∫•n ƒë·ªÅ l√† ta ph·∫£i ch·ªçn n∆°i d·ªØ li·ªáu Sharding r·∫•t c·∫©n th·∫≠n ƒë·ªÉ kh√¥ng g√¢y m·∫•t c√¢n b·∫±ng (unbalanced) gi·ªØa c√°c DB d·∫´n t·ªõi r·∫•t c√≥ th·ªÉ c√≥ m·ªôt v√†i Server s·∫Ω th√†nh ƒëi·ªÉm n√≥ng (hot spot), v√≠ d·ª• ng∆∞·ªùi d√πng ·ªü S√†i G√≤n ch·∫Øc ch·∫Øn l√† ƒë√¥ng h∆°n r·∫•t nhi·ªÅu l·∫ßn ng∆∞·ªùi d√πng ·ªü Bi√™n H√≤a hay Vƒ©nh Long.</li>
<li>Vertical sharing
L√† c√°ch sharding d·ªØ li·ªáu d·ª±a tr√™n t√≠nh nƒÉng (feature) c·ªßa h·ªá th·ªëng. V√≠ d·ª• ta thi·∫øt k·∫ø m·ªôt h·ªá th·ªëng chia s·∫ª ·∫£nh gi·ªëng Instagram, ta s·∫Ω l∆∞u th√¥ng tin c·ªßa User v√†o DB_Users, l∆∞u th√¥ng tin ·∫£nh h·ªç up l√™n tr√™n m·ªôt DB kh√°c l√† DB_Photos v√† th√¥ng tin danh s√°ch nh·ªØng ng∆∞·ªùi h·ªç follow ·ªü m·ªôt DB th·ª© 3 l√† DB_Follow.
C√°ch l√†m n√†y r·∫•t l√† r√µ r√†ng d·ªÖ ƒë·ªÉ implement v√† kh√¥ng l√†m ·∫£nh h∆∞·ªüng l·ªõn ƒë·∫øn ·ª©ng d·ª•ng, nh∆∞ng khi h·ªá th·ªëng l·ªõn d·∫ßn l√™n th√¨ d·ªØ li·ªáu c≈©ng l·ªõn d·∫ßn theo, do ƒë√≥ ta l·∫°i ph·∫£i th·ª±c hi·ªán sharding ti·∫øp nh·ªØng DB tr√™n t·ª´ng feature (b·ªüi v√¨ 1 DB kh√¥ng th·ªÉ s·ª≠ l√Ω 10 t·ª∑ b·ª©c ·∫£nh c·ªßa 140 tri·ªáu user ƒë∆∞·ª£c).</li>
<li>Directory Based sharding
C√°ch n√†y s·∫Ω y√™u c·∫ßu ta ph·∫£i thi·∫øt k·∫ø m·ªôt ‚Äúlookup service‚Äù c√≥ t√°c d·ª•ng quy·∫øt ƒë·ªãnh √°nh x·∫° (mapping) d·ªØ li·ªáu s·∫Ω n·∫±m ·ªü ƒë√¢u, DB n√†o. M·ªói khi c√≥ request ghi ho·∫∑c ƒë·ªçc s·∫Ω th√¥ng qua lookup service ƒë·ªÉ mapping v·ªã tr√≠ s·∫Ω ƒë·ªçc v√† ghi. Khi business m·ªü r·ªông s·ªë l∆∞·ª£ng server c√≥ th·ªÉ tƒÉng l√™n m√† kh√¥ng ·∫£nh h∆∞·ªüng hay ƒë√≤i h·ªèi ·ª©ng d·ª•ng ph·∫£i thay ƒë·ªïi theo.</li>
</ol>
<p><img src="/p/system-design-basic/ds2.png"
	width="1400"
	height="1180"
	srcset="/p/system-design-basic/ds2_hu5c3fc298dadb06c6ff8452e525425c94_123932_480x0_resize_box_3.png 480w, /p/system-design-basic/ds2_hu5c3fc298dadb06c6ff8452e525425c94_123932_1024x0_resize_box_3.png 1024w"
	loading="lazy"
	
		alt="v√≠ d·ª•"
	
	
		class="gallery-image" 
		data-flex-grow="118"
		data-flex-basis="284px"
	
></p>
<h3 id="nh·ªØng-ti√™u-ch√≠-ƒë·ªÉ-ph√¢n-v√πng-d·ªØ-li·ªáu">Nh·ªØng ti√™u ch√≠ ƒë·ªÉ ph√¢n v√πng d·ªØ li·ªáu</h3>
<p>B√™n tr√™n ta ƒë√£ t√¨m hi·ªÉu v√† c√°c method ƒë·ªÉ sharding d·ªØ li·ªáu, gi·ªù ta h√£y t√¨m ki·ªÉu s√¢u h∆°n v·ªÅ c√°c ti√™u ch√≠ ƒë·ªÉ ph√¢n v√πng d·ªØ li·ªáu.</p>
<ol>
<li>Ph√¢n v√πng theo key ho·∫∑c hash
H·ªá th·ªëng s·∫Ω √°p d·ª•ng c√°c h√†m bƒÉm (hash function) cho m·ªôt ho·∫∑c nhi·ªÅu c√°c key ch√≠nh trong d·ªØ li·ªáu (th∆∞·ªùng l√† ID) ƒë·ªÉ x√°c ƒë·ªãnh ra m·ªôt con s·ªë c·ªßa ph√¢n v√πng n√≥ ƒëang n·∫±m. V√≠ d·ª•: n·∫øu h·ªá th·ªëng c√≥ 100 m√°y ch·ªß DB v√† ID c·ªßa b·∫£n ghi s·∫Ω t·ª± tƒÉng l√™n m·ªói l·∫ßn m·ªôt b·∫£n ghi m·ªõi ƒë∆∞·ª£c ch√®n. Trong v√≠ d·ª• n√†y, h√†m bƒÉm c√≥ th·ªÉ l√† ‚ÄòID% 100, t·ª´ ƒë√≥ ta c√≥ th·ªÉ x√°c ƒë·ªãnh v·ªã tr√≠ c·ªßa d·ªØ li·ªáu. C√°ch ti·∫øp c·∫≠n n√†y c·∫ßn ƒë·∫£m b·∫£o ph√¢n b·ªï d·ªØ li·ªáu th·ªëng nh·∫•t gi·ªØa c√°c m√°y ch·ªß. Nh∆∞ng c√°ch l√†m n√†y c√≥ m·ªôt ƒëi·ªÉm y·∫øu l√† m·ªói khi ta thay ƒë·ªïi s·ªë l∆∞·ª£ng Server tƒÉng ho·∫∑c gi·∫£m th√¨ h√†m bƒÉm c≈©ng s·∫Ω ph·∫£i thay ƒë·ªïi theo v√† s·∫Ω xu·∫•t hi·ªán hi·ªán t∆∞·ª£ng x√°o tr·ªôn t·∫≠p d·ªØ li·ªáu tr√™n m·ªói server, v√† ƒë√≤i h·ªèi ta ph·∫£i ph√¢n ph·ªëi l·∫°i d·ªØ li·ªáu v√† xu·∫•t hi·ªán ƒë·ªô tr·ªÖ d·ªØ li·ªáu. C√≥ m·ªôt c√°ch gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y l√† s·ª≠ d·ª•ng Consistent Hashing (h√†m bƒÉm nh·∫•t qu√°n).</li>
<li>Ph√¢n v√πng theo danh s√°ch (list)
C√°ch ph√¢n v√πng s·∫Ω ƒë∆∞·ª£c quy·∫øt ƒë·ªãnh g√°n m·ªôt danh s√°ch c√°c gi√° tr·ªã ngay t·ª´ ƒë·∫ßu, t·ª´ ƒë√≥ m·ªói l·∫ßn ghi m·ªôt b·∫£n ghi m·ªõi ta s·∫Ω t√¨m ra gi√° tr·ªã c·ªßa b·∫£n ghi n·∫±m ·ªü ph√¢n v√πng n√†o v√† ghi v√†o ƒë√≥. V√≠ d·ª• ta s·∫Ω quy·∫øt ƒë·ªãnh nh√≥m t·∫•t c·∫£ c√°c ng∆∞·ªùi d√πng ·ªü Ai-len, Na Uy, Th·ª•y ƒêi·ªÉn, Ph·∫ßn Lan v√† ƒêan M·∫°ch v√† m·ªôt ph√¢n v√πng c√≥ t√™n l√† Nordic (B·∫Øc √Çu).
Ph√¢n v√πng v√≤ng tr√≤n (round-robin)
C√°ch ph√¢n v√πng n√†y r·∫•t ƒë∆°n gi·∫£n l√† m·ªói l·∫ßn c√≥ thao t√°c ghi ta s·∫Ω ghi v√≤ng tr√≤n quanh c√°c ph√¢n v√πng c√≥ s·∫µn. C√°ch l√†m n√†y ƒë∆°n gi·∫£n nh∆∞ng r·∫•t kh√≥ ƒë·ªÉ x√°c ƒë·ªãnh d·ªØ li·ªáu n√†o ·ªü ƒë√¢u l·∫•y ra khi c·∫ßn.</li>
<li>Ph√¢n v√πng t·ªïng h·ª£p
L√† c√°ch t·ªïng h·ª£p c√°c gi·∫£i ph√°p tr√™n th√†nh m·ªôt gi·∫£i ph√°p m·ªõi. V√≠ d·ª• ta c√≥ th·ªÉ √°p d·ª•ng ph√¢n v√πng theo Key/Hash v√† sau ƒë√≥ x√°c ƒë·ªãnh ƒë∆∞·ª£c key r·ªìi ta s·∫Ω √°p d·ª•ng ti·∫øp ph√¢n v√πng theo danh s√°ch ƒë·ªÉ ch·ª©a key sau khi hash v√†o m·ªôt danh s√°ch c·ª• th·ªÉ n√†o ƒë√≥. Consistent Hashing c√≥ th·ªÉ ƒë∆∞·ª£c coi l√† c√°ch ph√¢n v√πng t·ªïng h·ª£p.</li>
</ol>
<h3 id="c√°c-v·∫•n-ƒë·ªÅ-khi-sharding-d·ªØ-li·ªáu">C√°c v·∫•n ƒë·ªÅ khi Sharding d·ªØ li·ªáu</h3>
<p>V√¨ vi·ªác d·ªØ li·ªáu s·∫Ω b·ªã ph√¢n t√°n ƒëi nhi·ªÅu Server kh√°c nhau do v·∫≠y s·∫Ω ph√°t sinh m·ªôt v√†i v·∫•n ƒë·ªÅ khi sharding d·ªØ li·ªáu nh∆∞ sau:</p>
<ol>
<li>Joins and De-normalization
B·ªüi v√¨ vi·ªác d·ªØ li·ªáu ·ªü c√°c b·∫£ng ƒë∆∞·ª£c ph√¢n b·ªë v√† tr·∫£i r·ªông ƒëi nhi·ªÅu DB/Server kh√°c nhau n√™n vi·ªác join b·∫£ng d·ªØ li·ªáu l√† ƒëi·ªÅu r·∫•t kh√≥ khƒÉn v√† c≈©ng kh√¥ng ƒëem l·∫°i hi·ªáu xu·∫•t b·ªüi v√¨ vi·ªác d·ªØ li·ªáu ph·∫£i ƒë∆∞·ª£c queries t·ª´ nhi·ªÅu m√°y ch·ªß kh√°c nhau. ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y ta c√≥ th·ªÉ thi·∫øt k·∫ø d·ªØ li·ªáu d·∫°ng non-relationship DB hay c√≤n g·ªçi l√† NoSQL, gi·ªëng nh∆∞ MongoDB hay Cassandra hai h·ªá NoSQL r·∫•t n·ªïi ti·∫øng v√† h·ªó tr·ª£ Sharding v√¥ c√πng t·ªët. Tuy nhi√™n vi·ªác n√†y ta ph·∫£i ch·∫•p nh·∫≠n r·ªßi ro vi·ªác kh√¥ng nh·∫•t qu√°n d·ªØ li·ªáu (inconsistency)</li>
<li>Referential integrity
C≈©ng v√¨ l√Ω do tr√™n v·ªÅ vi·ªác truy v·∫•n ch√©o d·ªØ li·ªáu gi·ªØa c√°c DB n·∫±m tr√™n c√°c m√°y ch·ªß kh√°c nhau l√† b·∫•t kh·∫£ thi, do v·∫≠y vi·ªác r√†ng bu·ªôc kh√≥a ngo·∫°i ƒë·ªÉ b·∫£o ƒë·∫£m s·ª± to√†n v·∫πn d·ªØ li·ªáu c≈©ng l√† m·ªôt ƒëi·ªÅu v√¥ c√πng kh√≥ khƒÉn. H·∫ßu h·∫øt RDBMS kh√¥ng h·ªó tr·ª£ c√°c r√†ng bu·ªôc kh√≥a ngo·∫°i tr√™n c√°c c∆° s·ªü d·ªØ li·ªáu ph√¢n t√°n tr·ªÅn nhi·ªÅu server. Do v·∫≠y ƒë·ªÉ ƒë·∫°t ƒë∆∞·ª£c ƒëi·ªÅu n√†y ta ph·∫£i th·ª±c hi·ªán ƒëi·ªÅu n√†y tr√™n m√£ ·ª©ng d·ª•ng (code), ƒëi·ªÅu n√†y s·∫Ω tƒÉng t√≠nh ph·ª©c t·∫°p c·ªßa ·ª©ng d·ª•ng.</li>
<li>Rebalancing
Trong su·ªët qu√° tr√¨nh h·ªá th·ªëng v·∫≠n h√†nh c√≥ r·∫•t nhi·ªÅu l√Ω do ta thay ƒë·ªïi c√°c chi·∫øn thu·∫≠t hay c√°ch th·ª©c Sharding d·ªØ li·ªáu, nh∆∞ business tƒÉng tr∆∞·ªüng y√™u c·∫ßu th√™m Server‚Ä¶ V√† m·ªói khi nh∆∞ v·∫≠y ta ph·∫£i t√°i c√¢n b·∫±ng (rebalancing) d·ªØ li·ªáu tr√™n t·∫•t c·∫£ c√°c Server, c√≥ nghƒ©a l√† d·ªØ li·ªáu ph·∫£i ƒë∆∞·ª£c ph√¢n ph·ªëi l·∫°i tr√™n to√†n b·ªô server. ƒê·ªÉ l√†m ƒë∆∞·ª£c ƒëi·ªÅu n√†y m√† kh√¥ng c√≥ ƒë·ªô tr·ªÖ (downtime) l√† c·ª±c k·ª≥ kh√≥ khƒÉn. M√¥ h√¨nh sharding ‚ÄúDirectory Based‚Äù c√≥ kh·∫£ nƒÉng rebalancing t·ªët nh·∫•t nh∆∞ng l·∫°i tƒÉng ƒë·ªô ph·ª©c t·∫°p c·ªßa ·ª©ng d·ª•ng v√† t·∫°o th√™m m·ªôt single point of failure (v√≠ d·ª• ‚Äúlookup service‚Äù).</li>
</ol>
<p>T√≥m l·∫°i v·ªõi Sharding th√¨ m√¥ h√¨nh sharding v·ªõi key/hash v·ªõi Consistent Hashing hi·ªán t·∫°i l√† gi·∫£i ph√°p t·ªëi ∆∞u nh·∫•t cho vi·ªác Rebalancing.</p>
<h2 id="ph·∫ßn-5-indexes">Ph·∫ßn 5: Indexes</h2>
<p>C√≥ l·∫Ω thu·∫≠t ng·ªØ ‚Äúƒë√°nh index‚Äù ƒë√£ qu√° quen v·ªõi nh·ªØng ai l√†m vi·ªác v·ªõi CSDL, ƒë√≥ l√† c√°ch r·∫•t ph·ªï bi·∫øn ƒë·ªÉ tƒÉng t·ªëc ƒë·ªô query c·ªßa d·ªØ li·ªáu, khi d·ªØ li·ªáu Database ng√†y c√†ng tƒÉng v√† tr·ªü n√™n ch·∫≠m d·∫ßn ƒë·ªÅu theo th·ªùi gian. M·ª•c ti√™u c·ªßa vi·ªác t·∫°o Index l√† ƒë·ªÉ tƒÉng t·ªëc ƒë·ªô tr·∫£ v·ªÅ d·ªØ li·ªáu c·ªßa m·ªôt ho·∫∑c nhi·ªÅu tr∆∞·ªùng (rows) tr√™n m·ªôt b·∫£ng (table) c·ª• th·ªÉ n√†o ƒë√≥ b·∫±ng c√°ch t·∫°o Index tr√™n m·ªôt ho·∫∑c nhi·ªÅu c·ªôt (columns) c·ªßa m·ªôt database table.</p>
<p>ƒê·ªÉ hi·ªÉu r√µ h∆°n th·∫ø n√†o l√† Indexes ta h√£y ƒë·∫øn th·ª≠ m·ªôt nh√† s√°ch hay th∆∞ vi·ªán, th∆∞·ªùng c√°c cu·ªën s√°ch s·∫Ω ƒë∆∞·ª£c ph√¢n chia theo c√°c danh m·ª•c v·ªÅ n·ªôi dung nh∆∞: s√°ch n·∫•u ƒÉn, s√°ch ti·ªÉu thuy·∫øt n∆∞·ªõc ngo√†i, s√°ch t√¢m l√Ω, s√°ch l·ªãch s·ª≠ ‚Ä¶ N·∫øu ta mu·ªën t√¨m ki·∫øm m·ªôt lo·∫°i s√°ch theo n·ªôi dung mong mu·ªën th√¨ ch·ªâ vi·ªác t·ªõi c√° k·ªá s√°ch v·ªõi n·ªôi dung t∆∞∆°ng ·ª©ng, n√≥ s·∫Ω nhanh h∆°n l√† t√¨m ki·∫øm t·ª´ to√†n b·ªô c·∫£ nh√† s√°ch t·ª´. Ho·∫∑c v√≠ d·ª• kh√°c v·ªÅ c√°c ph·∫ßn m·ª•c l·ª•c trong mu·ªën cu·ªën s√°ch, n·∫øu ta mu·ªën t√¨m nhanh ƒë·∫øn ‚Äúch∆∞∆°ng h·ªìi‚Äù ta ƒëang c·∫ßn t√¨m ki·∫øm ho·∫∑c ƒë·ªçc d·ªü ch·ªâ c·∫ßn tra m·ª•c l·ª•c r·ªìi t√¨m t·ªõi ƒë√∫ng trang ch·ª©a n·ªôi dung.</p>
<p>Index trong Database c≈©ng gi·ªëng nh∆∞ v·∫≠y, v√≠ d·ª• ta c√≥ m·ªôt table l√† Books ch·ª©a 4 columns l√† ‚Äúbook_title‚Äù, ‚Äúwriter‚Äù, ‚Äúsubject‚Äù, v√† ‚Äúdate_of_publication‚Äù, th∆∞·ªùng th√¨ kh√°ch h√†ng s·∫Ω th∆∞·ªùng xuy√™n t√¨m ki·∫øm s√°ch theo hai ti√™u ch√≠ l√† t√™n s√°ch v√† t√°c gi·∫£, do ƒë√≥ ta s·∫Ω t·∫°o Index cho hai column l√† ‚Äúbook_title‚Äù v√† ‚Äúwriter‚Äù. Database s·∫Ω t·∫°o ra m·ªôt data structure ri√™ng bi·ªát ch·ª©a hai gi√° tr·ªã c·ªßa to√†n b·ªô n·ªôi dung (content) c√°c c·ªôt ƒë√°nh index v√† m·ªôt con tr·ªè (pointer) ƒë·ªÉ tr·ªè t·ªõi d·ªØ li·ªáu th·∫≠t s·ª± ƒëang n·∫±m ·ªü Database. Nh∆∞ v·∫≠y, s·ª≠ d·ª•ng index y√™u c·∫ßu c·∫ßn disk space ƒë·ªÉ ch·ª©a c·∫•u tr√∫c c·ªßa n√≥ v√† Index c≈©ng kh√¥ng l√†m thay ƒë·ªïi c·∫•u tr√∫c c·ªßa table. Do v·∫≠y m·ªói l√†m t√¨m ki·∫øm d·ªØ li·ªáu th√¨ Database s·∫Ω t√¨m ki·∫øm ·ªü Index sau ƒë√≥ d·ª±a v√†o con tr·ªè c·ªßa Index ƒë·ªÉ tr·∫£ v·ªÅ d·ªØ li·ªáu th·∫≠t.</p>
<p>Nh∆∞ng t·∫°i sao t√¨m ki·∫øm tr√™n Index l·∫°i nhanh h∆°n t√¨m ki·∫øm tr√™n Database, b·ªüi v√¨ Index lu√¥n lu√¥n s·∫Øp x·∫øp d·ªØ li·ªáu ƒë·ªÉ t·ªëi ∆∞u nh·∫•t cho c√°c thu·∫≠t to√°n th·ª±c hi·ªán vi·ªác t√¨m ki·∫øm, c√≤n d·ªØ li·ªáu Database th·∫≠t th√¨ lu√¥n s·∫Øp x·∫øp l·ªôn x·ªôn kh√¥ng c√≥ th·ª© t·ª± n√™n kh√¥ng thu·∫≠n ti·ªán cho vi·ªác t√¨m ki·∫øm. M·ªói Database s·∫Ω c√≥ c√°ch s·∫Øp x·∫øp Index v√† thu·∫≠t to√°n t√¨m ki·∫øm Index kh√°c nhau.</p>
<p><img src="/p/system-design-basic/idx.jpeg"
	width="1050"
	height="646"
	srcset="/p/system-design-basic/idx_hud3f00abfefc6b4d3b0f8f144ed2ee5e3_88293_480x0_resize_q75_box.jpeg 480w, /p/system-design-basic/idx_hud3f00abfefc6b4d3b0f8f144ed2ee5e3_88293_1024x0_resize_q75_box.jpeg 1024w"
	loading="lazy"
	
	
		class="gallery-image" 
		data-flex-grow="162"
		data-flex-basis="390px"
	
>
Tuy nhi√™n Index c≈©ng kh√¥ng ph·∫£i l√† m·ªôt magic keyword, vi·ªác ƒë√°nh Index c·∫ßn th·∫≠t c·∫©n tr·ªçng</p>
<ul>
<li>Th·ª© 1: Vi·ªác t·∫°o Index s·∫Ω t·ªën disk space, do ƒë√≥ ch·ªâ n√™n ƒë√°nh nh·ªØng c·ªôt d·ªØ li·ªáu c√≥ dung l∆∞·ª£ng nh·ªè, v√† s·∫Ω kh√¥ng c√≥ √Ω nghƒ©a g√¨ n·∫øu ƒë√°nh Index c·ªôt contents ki·ªÉu CLOB ch·ª©a n·ªôi dung c·ªßa m·ªôt article v√¨ l√∫c ƒë√≥ d·ªØ li·ªáu c·ªßa Index s·∫Ω to b·∫±ng nguy√™n c√°i table g·ªëc.</li>
<li>Th·ª© 2: Index th√¨ ta c≈©ng ph·∫£i c·∫ßn t·∫°o ra n√≥, v·ªõi m·ªôt d·ªØ li·ªáu l·ªõn s·∫µn r·ªìi m√† l√∫c n√†y ta m·ªõi ƒë√°nh Index th√¨ vi·ªác t·∫°o ra n√≥ l√† m·ªôt c√¥ng vi·ªác r·∫•t t·ªën th·ªùi gian v√† t√†i nguy√™n h·ªá th·ªëng. Cho n√™n t·ªët nh·∫•t h√£y l∆∞·ªùng tr∆∞·ªõc ta t·∫°o Index ngay t·ª´ khi d·ªØ li·ªáu c√≤n nh·ªè.</li>
<li>Th·ª© 3: Vi·ªác d·ªØ li·ªáu ƒë∆∞·ª£c th√™m m·ªõi s·ª≠a x√≥a (CUD) th∆∞·ªùng xuy√™n tr√™n Table g·ªëc th√¨ Index c≈©ng s·∫Ω ph·∫£i th√™m m·ªõi s·ª≠a v√† s·∫Øp x·∫øp l·∫°i, v·ªõi m·ªôt Table c√≥ d·ªØ li·ªáu l·ªõn th√¨ vi·ªác n√†y c≈©ng r·∫•t m·∫•t th·ªùi gian v√† n√≥ s·∫Ω l√†m ch·∫≠m ƒëi qu√° tr√¨nh update hay create d·ªØ li·ªáu t·ª´ table g·ªëc.</li>
</ul>
<p>Do ƒë√≥ ch·ªâ nh·ªØng Index th·ª±c s·ª± c·∫ßn thi·∫øt m·ªõi n√™n th√™m v√†o v√† n√™n th∆∞·ªùng xuy√™n xem x√©t l·∫°i v√† x√≥a nh·ªØng Index kh√¥ng th·ª±c s·ª± c·∫ßn thi·∫øt. V√† m·ª•c ti√™u ch√≠nh c·ªßa Index ƒë√≥ l√† tƒÉng kh·∫£ nƒÉng ƒë·ªçc (read) c·ªßa d·ªØ li·ªáu, do ƒë√≥ nh·ªØng Table d·∫°ng th∆∞·ªùng xuy√™n ghi nh∆∞ng √≠t khi ƒë∆∞·ª£c ƒë·ªçc th√¨ t·ªët nh·∫•t kh√¥ng n√™n t·∫°o Index, v√¨ n√≥ s·∫Ω gi·∫£m hi·ªáu xu·∫•t c·ªßa vi·ªác ghi d·ªØ li·ªáu.</p>
<h2 id="ph·∫ßn-6-proxies">Ph·∫ßn 6: Proxies</h2>
<p>Proxy server l√† m·ªôt server trung gian (intermediary) n·∫±m gi·ªØa client v√† back-end server. Client k·∫øt n·ªëi v·ªõi proxy server ƒë·ªÉ y√™u c·∫ßu (request) nh·ªØng d·ªãch v·ª• (service) c·∫ßn thi·∫øt nh∆∞ API, web page, file hay connection, v.V‚Ä¶ N√≥i t√≥m l·∫°i, proxy server l√† m·ªôt ph·∫ßn c·ªßa h·ªá th·ªëng ph·∫ßn m·ªÅm ho·∫∑c ph·∫ßn c·ª©ng ƒë√≥ng vai tr√≤ trung gian k·∫øt n·ªëi c√°c y√™u c·∫ßu t·ª´ client t·ªõi c√°c th√†nh ph·∫ßn kh√°c trong h·ªá th·ªëng.</p>
<p>Proxy ƒë∆∞·ª£c s·ª≠ d·ª•ng ch·ªß y·∫øu ƒë·ªÉ l·ªçc ho·∫∑c ghi log c√°c y√™u c·∫ßu (filter request, log request) ho·∫∑c ƒë·ªÉ thay ƒë·ªïi c√°c request (nh∆∞ th√™m ho·∫∑c x√≥a c√°c header, m√£ h√≥a/gi·∫£i m√£ hay n√©n c√°c resource). Ho·∫∑c m·ªôt ·ª©ng d·ª•ng r·∫•t h·ªØu √≠ch kh√°c l√† d√πng ƒë·ªÉ cache response r·ªìi tr·∫£ v·ªÅ cho nhi·ªÅu request c√πng lo·∫°i, nh∆∞ trong tr∆∞·ªùng h·ª£p nhi·ªÅu client request t·ªõi c√πng m·ªôt resource th√¨ Proxy c√≥ th·ªÉ cache resource ƒë√≥ r·ªìi tr·∫£ v·ªÅ cho c√°c client m√† kh√¥ng c·∫ßn g·ªçi t·ªõi c√°c ‚Äúremote server‚Äù kh√°c.</p>
<p>M√¥ h√¨nh Proxy Server ho·∫°t ƒë·ªông
C√°c ki·ªÉu Proxy Server
Open Proxy
M·ªôt Open Proxy Server l√† m·ªôt m√°y ch·ªß m√† b·∫•t k·ª≥ ng∆∞·ªùi d√πng Internet n√†o c≈©ng c√≥ th·ªÉ truy c·∫≠p. Th√¥ng th∆∞·ªùng n√≥ th∆∞·ªùng ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ ki·ªÉm xo√°t bƒÉng th√¥ng ho·∫∑c l∆∞u v√† chuy·ªÉn ti·∫øp c√°c d·ªãch v·ª• m·∫°ng nh∆∞ DNS ho·∫∑c c√°c d·ªãch v·ª• Web c·ªßa m·ªôt nh√≥m ng∆∞·ªùi d√πng s·ª≠ d·ª•ng chung Open Proxy ƒë√≥. C√≥ hai lo·∫°i Open Proxy l√†</p>
<ul>
<li>Proxy ·∫©n danh (Anonymous Proxy): Proxy server n√†y c√≥ th·ªÉ che d·∫•u c√°c IP th·∫≠t c·ªßa c√°c user s·ª≠ d·ª•ng n√≥ kh·ªèi c√°c d·ªãch v·ª• n√≥ truy c·∫≠p ƒë·∫øn. Proxy ·∫©n danh c√≥ t√°c d·ª•ng tƒÉng ƒë·ªô b·∫£o m·∫≠t cho ng∆∞·ªùi d√πng v√¨ ƒë·ªãa ch·ªâ IP th·ª±c c·ªßa ng∆∞·ªùi d√πng c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ truy d·∫´n ra th√¥ng tin v·ªÅ ng∆∞·ªùi d√πng v√† ƒë·ªÉ th√¢m nh·∫≠p v√†o m√°y t√≠nh c·ªßa ng∆∞·ªùi ƒë√≥. Ho·∫∑c d√πng ƒë·ªÉ v∆∞·ª£t qua t∆∞·ªùng l·ª≠a c·ªßa c√°c t·ªï ch·ª©c ho·∫∑c qu·ªëc gia Ngo√†i ra, proxy ·∫©n danh c√≤n ƒë∆∞·ª£c d√πng ƒë·ªÉ l√°ch qua s·ª± ki·ªÉm duy·ªát Internet c·ªßa c√°c ch√≠nh ph·ªß ho·∫∑c t·ªï ch·ª©c.</li>
<li>Proxy minh b·∫°ch (Tr–∞nsp–∞rent Proxy): Tr√°i ng∆∞·ª£c v·ªõi anonymous Proxy, th√¨ proxy n√†y cho ph√©p c√°c d·ªãch v·ª• truy c·∫≠p t·ªõi bi·∫øt ƒë∆∞·ª£c IP th·∫≠t c·ªßa user b·∫±ng c√°c HTTP header (v√≠ d·ª• nh∆∞ X-Forwarded-For). ∆Øu ƒëi·ªÉm c·ªßa Proxy n√†y l√† kh·∫£ nƒÉng cache response nh∆∞ website ƒë·ªÉ tƒÉng t·ªëc ƒë·ªô k·∫øt n·ªëi m·∫°ng c·ªßa nh·ªØng ng∆∞·ªùi d√πng b√™n trong m√°y ch·ªß Proxy.
Reverse Proxy
Reverse proxy l√† m·ªôt proxy server m√† khi ƒë·ª©ng tr∆∞·ªõc client, c√≥ t√°c d·ª•ng chuy·ªÉn ti·∫øp request ƒë·∫øn m·ªôt ho·∫∑c nhi·ªÅu back-end server v√† nh·∫≠n k·∫øt qu·∫£ t·ª´ c√°c server n√†y r·ªìi tr·∫£ v·ªÅ ph√≠a client (forwarder), gi√∫p che d·∫•u danh t√≠nh c·ªßa c√°c back-end server b√™n d∆∞·ªõi. Reverse proxy ƒë∆∞·ª£c c√†i ƒë·∫∑t trong m·ªôt private network c·ªßa m·ªôt ho·∫∑c nhi·ªÅu server, v√† t·∫•t c·∫£ l∆∞u l∆∞·ª£ng truy c·∫≠p ƒë·ªÅu ph·∫£i ƒëi qua proxy n√†y.
Th√¥ng th∆∞·ªùng, nh·ªØng server s·∫Ω s·ª≠ d·ª•ng c∆° ch·∫ø reverse proxy n√†y ƒë·ªÉ b·∫£o v·ªá c√°c ·ª©ng d·ª•ng c√≥ kh·∫£ nƒÉng x·ª≠ l√Ω HTTP y·∫øu k√©m h∆°n. V√≠ d·ª• nh∆∞ kh·∫£ nƒÉng x·ª≠ l√Ω c·ª±c l·ªõn c√°c request, nh·ªØng h·∫°n ch·∫ø v·ªÅ x·ª≠ l√Ω s·ª± ƒëa d·∫°ng c·ªßa c√°c lo·∫°i request (c√°c d·∫°ng request c√≥ th·ªÉ k·ªÉ ƒë·∫øn nh∆∞: HTTP(S) 1.x, HTTP(S) 2.x, ‚Ä¶) hay kh·∫£ nƒÉng chuy·ªÉn ƒë·ªïi HTTPS th√†nh HTTP, cache request, x·ª≠ l√Ω d·ªØ li·ªáu c·ªßa cookies/session, chia m·ªôt request th√†nh nhi·ªÅu request nh·ªè h∆°n r·ªìi t·ªïng h·ª£p l·∫°i c√°c response, ‚Ä¶</li>
</ul>
<p>Reverse Proxy</p>
<h2 id="ph·∫ßn-7-sao-l∆∞u-v√†-ƒë·ªìng-b·ªô-d·ªØ-li·ªáu--redundancy-and-replication">Ph·∫ßn 7: Sao l∆∞u v√† ƒë·ªìng b·ªô d·ªØ li·ªáu ‚Äî Redundancy and Replication</h2>
<p>Redundancy
L√† ph∆∞∆°ng th·ª©c sao l∆∞u c√°c d·ªØ li·ªáu quan tr·ªçng c·ªßa h·ªá th·ªëng v·ªõi m·ª•c ƒë√≠ch tƒÉng ƒë·ªô tin c·∫≠y (Reliability) c·ªßa h·ªá th·ªëng. V√≠ d·ª• d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr√™n duy nh·∫•t m·ªôt Server, n·∫øu Server ƒë√≥ m·∫•t c√≥ nghƒ©a l√† t·∫•t c·∫£ d·ªØ li·ªáu ƒë√≥ m·∫•t, do ƒë√≥ vi·ªác t·∫°o ra c√°c b·∫£n sao l∆∞u l√† ƒë·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y. Redundancy l√† m·ªôt ƒëi·ªÅu ki·ªán ƒë·ªÉ x√≥a b·ªè nh·ªØng ‚Äúsingle points of failure‚Äù v√† t·∫°o ra c√°c b·∫£n sao l∆∞u l√∫c c·∫ßn thi·∫øt, v√≠ d·ª• ta c√≥ hai m√°y ch·ªß Database ƒëang ch·∫°y tr√™n production v√† d·ªØ li·ªáu lu√¥n ƒë∆∞·ª£c sao l∆∞u ƒë·ªìng b·ªô gi·ªØa hai m√°y ch·ªß, v√† n·∫øu c√≥ m·ªôt trong hai m√°y ch·ªß b·ªã down th√¨ ta c√≥ th·ªÉ failover sang m√°y ch·ªß c√≤n l·∫°i. Redundancy n√≥ gi·ªëng nh∆∞ duplicate l·∫°i node/server d√πng cho m·ª•c ƒë√≠ch back-up v·∫≠y.</p>
<p>Replication
G·∫ßn t∆∞∆°ng t·ª± v·ªõi v·ªõi Redundancy l√† ta c≈©ng t·∫°o ra m·ªôt b·∫£n sao l∆∞u d·ªØ li·ªáu c·ªßa Server ch√≠nh (Master) sang Server backup (Slave), nh∆∞ng kh√°c nhau c∆° b·∫£n l√† Replication s·∫Ω update d·ªØ li·ªáu gi·ªØa Master v√† Slave l√† lu√¥n lu√¥n gi·ªëng nhau v√† m·ªçi th·ªùi ƒëi·ªÉm (real time synchronization) ƒë·ªÉ tƒÉng ƒë·ªô tin c·∫≠y (reliability), ƒë·∫∑c bi·ªát l√† kh·∫£ nƒÉng ch·ªãu l·ªói c·ªßa h·ªá th·ªëng (fault-tolerance) v√† kh·∫£ nƒÉng truy c·∫≠p (accessibility). Replication ƒë∆∞·ª£c s·ª≠ d·ª•ng r·ªông r√£i ·ªü c√°c CSDLQH (RDBMS) trong m√¥ h√¨nh master/slave, d·ªØ li·ªáu gi·ªØa master-slave lu√¥n lu√¥n ƒë∆∞·ª£c ƒë·ªìng b·ªô, trong tr∆∞·ªùng h·ª£p master down th√¨ slave s·∫Ω l√™n thay master sau khi master v·ª´a down s·ªëng d·∫≠y n√≥ s·∫Ω tr·ªü th√†nh slave m√† s·∫Ω th·ª±c hi·ªán ƒë·ªìng b·ªô d·ªØ li·ªáu ch∆∞a ƒë∆∞·ª£c update trong th·ªùi gian n√≥ b·ªã down.</p>
<p>M√¥ h√¨nh Master ‚Äî Slave</p>
<h2 id="ph·∫ßn-8-sql-vs-nosql">Ph·∫ßn 8: SQL vs. NoSQL</h2>
<p>Trong th·∫ø gi·ªõi c·ªßa CSDL hi·ªán t·∫°i ta c√≥ hai lo·∫°i gi·∫£i ph√°p ch√≠nh ƒë√≥ l√†: SQL v√† NoSQL (c∆° s·ªü d·ªØ li·ªáu quan h·ªá v√† c∆° s·ªü d·ªØ li·ªáu phi quan h·ªá). C·∫£ hai ƒë·ªÅu r·∫•t kh√°c nhau v·ªÅ c√°ch ch√∫ng ƒë∆∞·ª£c x√¢y d·ª±ng, lo·∫°i d·ªØ li·ªáu n√≥ ch√∫ng l∆∞u tr·ªØ v√† c·∫£ c√°ch th·ª©c l∆∞u tr·ªØ d·ªØ li·ªáu c·ªßa ch√∫ng.
C∆° s·ªü d·ªØ li·ªáu quan h·ªá l∆∞u tr·ªØ nh·ªØng d·ªØ li·ªáu c√≥ c·∫•u tr√∫c r√µ r√†ng v√≠ d·ª• nh∆∞ danh b·∫° ƒëi·ªán tho·∫°i th√¨ s·∫Ω ch·∫Øc ch·∫Øn s·∫Ω ch·ª©a t√™n ng∆∞·ªùi v√† s·ªë ƒëi·ªán tho·∫°i c·ªßa ng∆∞·ªùi ƒë√≥. C√≤n c∆° s·ªü d·ªØ li·ªáu phi quan h·ªá l∆∞u tr·ªØ gi·ªØ li·ªáu kh√¥ng c√≥ c·∫•u tr√∫c, c·∫•u tr√∫c c·ªßa n√≥ r·∫•t ƒë·ªông v√† ph√¢n t√°n, v√≠ d·ª• nh∆∞ ch·ª©a m·ªôt t·ªáp t√†i li·ªáu (document) v·ªÅ ng∆∞·ªùi d√πng nh∆∞ s·ªë ƒëi·ªán tho·∫°i, ƒë·ªãa ch·ªâ, hay nh·ªØng activity c·ªßa h·ªç tr√™n Facebook hay c√°c trang mua s·∫Øm tr·ª±c tuy·∫øn. D·ªØ li·ªáu c·ªßa n√≥ th∆∞·ªùng d∆∞·ªõi d·∫°ng key-value d·∫°ng JSON, v√† nh·ªØng document c√≥ th·ªÉ ƒë∆∞·ª£c t·∫°o m√† kh√¥ng c·∫ßn ph·∫£i x√°c ƒë·ªãnh tr∆∞·ªõc c·∫•u tr√∫c.</p>
<p>SQL
CSDLQH ch·ª©a d·ªØ li·ªáu theo d·∫°ng d√≤ng (rows) v√† c·ªôt(columns). M·ªói d√≤ng s·∫Ω ch·ª©a nh·ªØng th√¥ng tin c·ªßa d·ªØ li·ªáu v√† m·ªói c·ªôt s·∫Ω ch·ª©a nh·ªØng ƒë·∫∑c ƒëi·ªÉm c·ªßa d·ªØ li·ªáu, gi·ªØa c√°c b·∫£ng c√≥ th·ªÉ c√≥ li√™n k·∫øt v·ªõi nhau qua kh√≥a ngo·∫°i (foreign key). M·ªôt s·ªë CSDLQH ph·ªï bi·∫øn l√† MySQL, Oracle, MS SQL Server, SQLite, Postgres, MariaDB v√† IMB D2.</p>
<p>NoSQL
NoSQL ƒë∆∞·ª£c ph√¢n th√†nh 4 lo·∫°i ch√≠nh sau:</p>
<p>Key-Value Stores:
D·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c l∆∞u d∆∞·ªõi d·∫°ng c·∫∑p key-value, v·ªõi ‚Äòkey‚Äô l√† thu·ªôc t√≠nh duy nh·∫•t ƒë·ªÉ li√™n k·∫øt v·ªõi gi√° tr·ªã (value) c·ªßa n√≥. C√°c Key-Value stores n·ªïi ti·∫øng bao g·ªìm Redis hay Amazon DynamoDB.</p>
<p>Document Databases:
L√† DB ch·ª©a d·ªØ li·ªáu d·∫°ng theo ki·ªÉu c√°c t·ªáp t√†i li·ªáu (document) ƒë·ªÉ thay th·∫ø cho ki·ªÉu d√≤ng v√† c·ªôt trong table v√† nhi·ªÅu document g·ªôp l·∫°i s·∫Ω th√†nh m·ªôt Collection. Kh√°c v·ªõi ki·ªÉu table l√† m·ªói document s·∫Ω ch∆∞a c√°c d·∫°ng c·∫•u tr√∫c kh√°c nhau. V√≠ d·ª• trong MongoDB th√¨ m·ªói document s·∫Ω ch·ª©a d·ªØ li·ªáu ki·ªÉu JSON, t·ª©c l√† m·ªói document l√† m·ªôt JSON. Document DB ti√™u bi·ªÉu hi·ªán t·∫°i c√≥ MongoDB v√† CouchDB.</p>
<p>Wide-Column Databases: Wide-Column hay c√≤n g·ªçi l√† Big-Table l√† m√¥ h√¨nh d·ªØ li·ªáu ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu v·ªõi kh·∫£ nƒÉng m·ªói rows ch·ª©a r·∫•t nhi·ªÅu column(c·ªôt) m·ªói c·ªôt l·∫°i l√† m·ªôt c·∫∑p key-value, v√† ·ªü ƒë√¢y s·ªë l∆∞·ª£ng c·ªôt l√† t√πy bi·∫øn (dynamic) cho m·ªói rows, c√≥ nghƒ©a l√† s·ªë c·ªôt ·ªü m·ªói rows l√† kh√°c nhau. C√≥ th·ªÉ th·∫•y n√≥ gi·ªëng nh∆∞ ki·ªÉu key-value hai chi·ªÅu v·ªõi m·ªói key l·∫°i ch·ª©a nhi·ªÅu c·∫∑p key-value b√™n trong. C√°c Wide-Column DB ti√™u bi·ªÉu bao g·ªìm Cassandra hay HBase.</p>
<p>Graph Databases DB d·∫°ng n√†y s·∫Ω l∆∞u d·ªØ li·ªáu d·∫°ng c·∫•u tr√∫c d·ªØ li·ªáu ki·ªÉu ƒë·ªì th·ªã (graph) ƒë·ªÉ bi·ªÉu th·ªã m·ªëi quan h·ªá gi·ªØa c√°c d·ªØ li·ªáu v·ªõi nhau. D·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u v√†o c√°c nodes (entities) v√† thu·ªôc t√≠nh c·ªßa node, li√™n k·∫øt gi·ªØa c√°c nodes s·∫Ω qua c√°c lines. Graph DB ph·ªï bi·∫øn c√≥ Neo4J v√† InfiniteGraph.</p>
<p>M√¥ t·∫£ quan h·ªá tr√™n Facebook c·ªßa ng∆∞·ªùi d√πng s·ª≠ d·ª•ng Graph DB
S·ª± kh√°c nhau gi·ªØa SQL v√† NoSQL
L∆∞u tr·ªØ ‚Äî Storage:</p>
<ul>
<li>SQL l∆∞u tr·ªØ d·ªØ li·ªáu trong c√°c b·∫£ng (tables) trong ƒë√≥ m·ªói row ƒë·∫°i di·ªán cho m·ªôt th·ª±c th·ªÉ d·ªØ li·ªáu (entity), v√† m·ªói column s·∫Ω ch·ª©a c√°c thu·ªôc t√≠nh c·ªßa entity; v√≠ d·ª• n·∫øu ta ch·ª©a d·ªØ li·ªáu c·ªßa th·ª±c th·ªÉ xe h∆°i (car entity) ta s·∫Ω l∆∞u tr·ªØ v√†o m·ªôt b·∫£ng d·ªØ li·ªáu c√≥ nhi·ªÅu column ƒë·∫°i di·ªán cho ƒë·∫∑c ƒëi·ªÉm c·ªßa chi·∫øc xe ƒë√≥ nh∆∞ ‚Äúm√†u‚Äù ‚Äúnh√£n hi·ªáu‚Äù ‚Äúh√£ng s·∫£n xu·∫•t‚Äù ‚Ä¶</li>
<li>NoSQL l∆∞u tr·ªØ d·ªØ li·ªáu tr√™n r·∫•t nhi·ªÅu lo·∫°i c·∫•u tr√∫c d·ªØ li·ªáu kh√°c nhau nh∆∞ ƒë√£ b√†n b√™n tr√™n nh∆∞ d·∫°ng key-value, document hay graph.</li>
</ul>
<p>L∆∞·ª£c ƒë·ªì d·ªØ li·ªáu c·ªßa th·ª±c th·ªÉ ‚Äî Schema:</p>
<ul>
<li>Trong SQL th√¨ m·ªói b·∫£n ghi c√≥ schema l√† c·ªë ƒë·ªãnh, t·ª©c l√† m·ªói column trong table ph·∫£i ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a t·ª´ tr∆∞·ªõc khi t·∫°o b·∫£ng, v√† m·ªói khi d·ªØ li·ªáu ƒë∆∞·ª£c th√™m v√†o m·ªôt row th√¨ c√°c column c·ªßa n√≥ ph·∫£i c√≥ gi√° tr·ªã (ch·∫•p nh·∫≠n gi√° tr·ªã NULL). C√°c schema c√≥ th·ªÉ ƒë∆∞·ª£c thay ƒë·ªïi sau ƒë√≥ (alter table), nh∆∞ng s·ª± thay ƒë·ªïi n√†y ph·∫£i n·∫±m ·ªü ph√≠a Database v√† khi DB th·ª±c hi·ªán thay ƒë·ªïi n√†y n√≥ s·∫Ω offline t·∫°m th·ªùi.</li>
<li>Trong NoSQL, schema l√† ƒë·ªông (dynamic) c√≥ nghƒ©a l√† ta kh√¥ng c·∫ßn ph·∫£i ƒë·ªãnh nghƒ©a m·ªôt schema n√†o tr∆∞·ªõc m√† schema s·∫Ω ƒë∆∞·ª£c d·ª±a v√†o c·∫•u tr√∫c c·ªßa records ƒë∆∞·ª£c ƒë∆∞a v√†o.</li>
</ul>
<p>Truy v·∫•n ‚Äî Querying:</p>
<ul>
<li>SQL truy v·∫•n th√¥ng qua m·ªôt ng√¥n ng·ªØ truy v·∫•n mang t√≠nh c·∫•u tr√∫c ƒë∆∞·ª£c g·ªçi l√† Structured Query Language (SQL) thao t√°c v·ªõi d·ªØ li·ªáu. SQL l√† m·ªôt ng√¥n ng·ªØ r·∫•t m·∫°nh m·∫Ω v√† l√¢u ƒë·ªùi l√† ƒë·∫°i di·ªán duy nh·∫•t cho to√†n b·ªô c√°c RDBMS kh√°c nhau.</li>
<li>NoSQL truy v·∫•n c·ªßa n√≥ th∆∞·ªùng ƒë∆∞·ª£c g·ªçi l√† UnSQL (Unstructured Query Language) m·ªói d·∫°ng NoSQL kh√°c nhau s·∫Ω c√≥ c·∫•u tr√∫c c√∫ ph√°p (syntax) kh√°c nhau ƒë·ªÉ c√≥ th·ªÉ l·∫•y ra c√°c d·∫°ng d·ªØ li·ªáu kh√°c nhau (collection, key-value, node ‚Ä¶)</li>
</ul>
<p>Kh·∫£ nƒÉng m·ªü r·ªông ‚Äî Scalability:</p>
<ul>
<li>Trong h·∫ßu h·∫øt c√°c RDBMS th√¨ kh·∫£ nƒÉng m·ªü r·ªông l√† theo chi·ªÅu d·ªçc (vertically scalable) v√≠ d·ª• nh∆∞ tƒÉng s·ª©c m·∫°nh ph·∫ßn c·ª©ng c·ªßa m√°y ch·ªß hi·ªán t·∫°i (tƒÉng CPU, Ram‚Ä¶), t·∫•t nhi√™n r·∫±ng c√°ch l√†m n√†y r·∫•t ƒë·∫Øt ƒë·ªè c≈©ng nh∆∞ t·ªën th·ªùi gian m√† ƒë·∫∑c bi·ªát l√† n√≥ lu√¥n c√≥ gi·ªõi h·∫°n n√†o ƒë√≥.</li>
<li>C√≤n v·ªõi NoSQL DB th√¨ h·ªó tr·ª£ r·∫•t t·ªët cho m·ªü r·ªông theo chi·ªÅu ngang (horizontally scalable), c√≥ nghƒ©a l√† ƒë∆°n gi·∫£n ch·ªâ th√™m server v√†o c√°c nodes hi·ªán c√≥, c√°ch l√†m n√†y ƒë∆°n gi·∫£n c≈©ng nh∆∞ r·∫ª ti·ªÅn h∆°n. Ph·∫ßn l·ªõn c√°c NoSQL DB c√¥ng vi·ªác n√†y ƒë√£ ƒë∆∞·ª£c h·ªó tr·ª£ s·∫µn v√† ƒë∆∞·ª£c l√†m t·ª± ƒë·ªông, c√≥ nghƒ©a l√† r·∫•t d·ªÖ ƒë·ªÉ tri·ªÉn khai.</li>
</ul>
<p>ƒê·ªô tin c·∫≠y ‚Äî Reliability:</p>
<ul>
<li>H·∫ßu h·∫øt c√°c RDBMS ƒë·ªÅu tu√¢n th·ªß theo c√°c thu·ªôc t√≠nh c·ªßa ACID (atomicity, consistency, isolation, v√† durability) v√¨ v·∫≠y n√≥ r·∫•t ƒë·∫£m b·∫£o ƒë·ªô tin c·∫≠y v√† b·∫£o to√†n d·ªØ li·ªáu.</li>
<li>C√≤n v·ªõi NoSQL th√¨ ƒëa ph·∫ßn s·∫Ω hy sinh t√≠nh ch·∫•t ACID ƒë·ªÉ ƒë√°nh ƒë·ªïi v·ªõi performance (hi·ªáu nƒÉng) v√† kh·∫£ nƒÉng m·ªü r·ªông (scalability).</li>
</ul>
<p>Khi n√†o th√¨ ch√∫ng ta s·ª≠ d·ª•ng SQL hay NoSQL
SQL hay NoSQL ƒë·ªÅu c√≥ nh·ªØng t√≠nh ch·∫•t kh√°c nhau ph·ª•c v·ª• cho nh·ªØng nhu c·∫ßu ƒë·∫∑c bi·ªát kh√°c nhau, do v·∫≠y kh√¥ng c√≥ DB n√†o th·ª±c s·ª± l√† ho√†n h·∫£o ph√π h·ª£p cho m·ªçi nhu c·∫ßu t√πy v√†o m·ª•c ƒë√≠ch c·ªßa h·ªá th·ªëng s·ªü t·∫°i. Ngay c·∫£ khi hi·ªán t·∫°i NoSQL ƒëang tr·ªü n√™n ph·ªï bi·∫øn r·ªông r√£i v·ªÅ t·ªëc ƒë·ªô v√† kh·∫£ nƒÉng m·ªü r·ªông, nh∆∞ng v·∫´n c√≥ t√¨nh hu·ªëng m√† m·ªôt SQL DB s·∫Ω ho·∫°t ƒë·ªông t·ªët h∆°n (v√≠ d·ª• h·ªá th·ªëng v·ªÅ giao d·ªãch ti·ªÅn t·ªá c·∫ßn ƒë·∫£m b·∫£o v·ªÅ t√≠nh ACID)</p>
<p>L√Ω do s·ª≠ d·ª•ng SQL DB:</p>
<pre><code>1. ·ª®ng d·ª•ng y√™u c·∫ßu s·ª≠ l√Ω d·ªØ li·ªáu theo c√°c transaction ƒë·ªÉ tu√¢n th·ªß t√≠nh ACID ƒë·ªÉ b·∫£o to√†n t√≠nh nh·∫•t qu√°n v√† to√†n v·∫πn c·ªßa d·ªØ li·ªáu b·∫±ng c√°ch quy ƒë·ªãnh c√°c thu·ªôc t√≠nh ACID b·∫Øt bu·ªôc khi th·ª±c hi·ªán m·ªôt transaction, v√≠ d·ª• nh∆∞ c√°c h·ªá th·ªëng v·ªÅ t√†i ch√≠nh hay th∆∞∆°ng m·∫°i ƒëi·ªán t·ª≠.
2. N·∫øu ·ª©ng d·ª•ng c·ªßa h·ªá th·ªëng ƒë∆∞·ª£c x√°c ƒë·ªãnh tr∆∞·ªõc c·∫•u tr√∫c d·ªØ li·ªáu, v√† nghi·ªáp v·ª• kh√¥ng ƒë√≤i h·ªèi s·ª± m·ªü r·ªông trong t∆∞∆°ng lai v√† ƒë√≤i h·ªèi s·ª± nh·∫•t qu√°n (consistent) trong d·ªØ li·ªáu.
</code></pre>
<p>L√Ω do s·ª≠ d·ª•ng NoSQL DB:</p>
<pre><code>1. H·ªá th·ªëng ƒë√≤i h·ªèi c·∫ßn l∆∞u m·ªôt s·ªë l∆∞·ª£ng c·ª±c l·ªõn d·ªØ li·ªáu kh√¥ng c√≥ c·∫•u tr√∫c r√µ r√†ng ngay t·ª´ ƒë·∫ßu v√† tƒÉng d·∫ßn theo th·ªùi gian. L√∫c n√†y NoSQL l√† s·ª± l·ª±a ch·ªçn t·ªët nh·∫•t v√¨ t√≠nh kh√¥ng r·∫±ng bu·ªôc trong ki·ªÉu d·ªØ li·ªáu (data type) b·∫±ng c√°ch l∆∞u tr·ªØ d·ªØ li·ªáu d·∫°ng document v√† t√≠nh ch·∫•t m·ªü r·ªông theo chi·ªÅu ngang (horizontally scalable).
2. C√°c h·ªá th·ªëng c·∫ßn ph√°t tri·ªÉn nhanh (rapid development). NoSQL r·∫•t ph√π h·ª£p v·ªõi rapid development b·ªüi v√¨ n√≥ kh√¥ng c·∫ßn m·∫•t th·ªùi gian chu·∫©n b·ªã (c·∫•u tr√∫c DB, c·∫•u tr√∫c b·∫£ng c·ªôt‚Ä¶). N·∫øu ch√∫ng ta c·∫ßn l√†m vi·ªác v·ªõi h·ªá th·ªëng nghi·ªáp v·ª• ch∆∞a th·ª±c s·ª± r√µ r√†ng ngay t·ª´ ƒë·∫ßu v√† ƒë√≤i h·ªèi s·ª± linh ho·∫°t thay ƒë·ªïi ‚Äúdata type‚Äù gi·ªØa c√°c sprint m√† kh√¥ng ·∫£nh h∆∞·ªüng c≈©ng nh∆∞ ƒë√≤i h·ªèi s·ª± thay ƒë·ªïi hay ƒë·ªô tr·ªÖ (downtime) t·ªõi h·ªá th·ªëng gi·ªØa c√°c version, l√∫c n√†y c∆° s·ªü d·ªØ li·ªáu quan h·ªá (RDBMS) s·∫Ω l√†m ch·∫≠m ch√∫ng ta l·∫°i.
3. H·ªá th·ªëng ƒë∆∞·ª£c x√¢y d·ª±ng v√† l∆∞u tr·ªØ d·ªØ li·ªáu tr√™n Cloud Computing. L∆∞u tr·ªØ d·ªØ li·ªáu tr√™n Cloud l√† m·ªôt gi·∫£i ph√°p ti·∫øt ki·ªám chi ph√≠ tuy·ªát v·ªùi nh∆∞ng ƒë√≤i h·ªèi d·ªØ li·ªáu ph·∫£i l∆∞u tr·ªØ ƒë·ªìng th·ªùi tr√™n nhi·ªÅu m√°y ch·ªß ƒë·ªÉ m·ªü r·ªông quy m√¥ (scale up). NoSQL nh∆∞ Cassandra ƒë∆∞·ª£c thi·∫øt k·∫ø t·ªëi ∆∞u cho vi·ªác n√†y m√† kh√¥ng c·∫ßn ta ph·∫£i ƒë·ªông tay ƒë·ªông ch√¢n qu√° nhi·ªÅu.
</code></pre>
<p>(*) Bonus: B√™n tr√™n t√¥i nh·∫Øc kh√° nhi·ªÅu v·ªÅ transaction v√† ACID, v·∫≠y h√£y ƒëi qua m·ªôt ch√∫t th·∫ø n√†o l√† m·ªôt transaction v√† ACID?</p>
<p>M·ªôt transaction l√† m·ªôt qu√° tr√¨nh x·ª≠ l√Ω t·ª´ khi b·∫Øt ƒë·∫ßu t·ªõi khi k·∫øt th√∫c th·ªèa m√£n b·ªën t√≠nh ch·∫•t ACID. B·ªën ch·ªØ ƒë√≥ vi·∫øt t·∫Øt c·ªßa b·ªën t√≠nh ch·∫•t quan tr·ªçng sau:
Atomicity: t√≠nh ‚Äúnguy√™n t·ª≠‚Äù c·ªßa giao d·ªãch. Nghƒ©a l√† m·ªçi giao d·ªãch ch·ªâ th√†nh c√¥ng khi t·∫•t c·∫£ c√°c ph·∫ßn th√†nh c√¥ng All or Nothings.
Consistency: t√≠nh nh·∫•t qu√°n. Nghƒ©a l√† m·ªçi d·ªØ li·ªáu ƒë∆∞·ª£c thao t√°c ƒë·ªÅu nh·∫•t qu√°n v·ªõi t·∫•t c·∫£ c√°c quy t·∫Øc (rules), c√°c r√†ng bu·ªôc (constraint)‚Ä¶ trong to√†n b·ªô qu√° tr√¨nh x·ª≠ l√Ω t·ª´ khi b·∫Øt ƒë·∫ßu t·ªõi khi k·∫øt th√∫c.
Isolation: t√≠nh c√¥ l·∫≠p. N√≥ ƒë·∫£m b·∫£o vi·ªác th·ª±c thi ƒë·ªìng th·ªùi c·ªßa c√°c giao d·ªãch ch·ªâ c√≥ th·ªÉ c√≥ k·∫øt qu·∫£ khi c√°c giao d·ªãch ƒë∆∞·ª£c th·ª±c hi·ªán tu·∫ßn t·ª±. V√≠ d·ª•: hai giao d·ªãch c√πng s·ª≠a m·ªôt table, th√¨ c√°c giao d·ªãch ƒë√≥ ph·∫£i ƒë∆∞·ª£c th·ª±c hi·ªán tu·∫ßn t·ª±, giao d·ªãch n√†y xong m·ªõi t·ªõi giao d·ªãch kia.
Durability: t√≠nh b·ªÅn. Nghƒ©a l√† m·ªçi giao d·ªãch khi commit th√¨ k·∫øt qu·∫£ n√≥ ph·∫£i ƒë∆∞·ª£c ƒë·∫£m b·∫£o, cho d√π ·ª©ng d·ª•ng b·ªã t·∫Øt, m·∫•t ƒëi·ªán server.</p>
<h2 id="ph·∫ßn-9-ƒë·ªãnh-l√Ω-cap--cap-theorem">Ph·∫ßn 9: ƒê·ªãnh l√Ω CAP / CAP Theorem</h2>
<p>ƒê·ªãnh l√Ω CAP n√≥i r·∫±ng m·ªôt h·ªá th·ªëng ph√¢n t√°n (distributed system) kh√¥ng th·ªÉ th·ªèa m√£n c·∫£ ba y·∫øu t·ªë CAP ƒë√≥ l√†:</p>
<p>Consistency: t√≠nh nh·∫•t qu√°n, t·∫•t c·∫£ c√°c node ph·∫£i c√≥ d·ªØ li·ªáu ƒë·ªìng nh·∫•t v·ªõi nhau.
Availability: t√≠nh s·∫µn s√†ng ho·∫°t ƒë·ªông c·ªßa c√°c node. H·ªá th·ªëng c√≥ th·ªÉ v·∫´n ho·∫°t ƒë·ªông ƒë∆∞·ª£c khi m·ªôt s·ªë node b·ªã ch·∫øt ho·∫∑c kh√¥ng s·∫µn s√†ng.
Partition Fault Tolerance: tr·∫°ng th√°i ho·∫°t ƒë·ªông c·ªßa h·ªá th·ªëng khi ƒë∆∞·ªùng k·∫øt n·ªëi (m·∫°ng) gi·ªØa c√°c node b·ªã ƒë·ª©t, hay c√≤n g·ªçi l√† kh·∫£ nƒÉng ch·ªãu l·ªói c·ªßa h·ªá th·ªëng. H·ªá th·ªëng v·∫´n ph·∫£i ho·∫°t ƒë·ªông b√¨nh th∆∞·ªùng cho d√π c√°c k·∫øt n·ªëi c·ªßa c√°c node trong h·ªá th·ªëng b·ªã ƒë·ª©t g√£y.</p>
<p>ƒê·ªãnh lu·∫≠t CAP
Ch√∫ng ta kh√¥ng th·ªÉ thi·∫øt k·∫ø m·ªôt h·ªá th·ªëng bao g·ªìm c·∫£ ba t√≠nh CAP, b·ªüi v√¨ ƒë·∫£m b·∫£o t√≠nh C (consistency) t·∫•t c·∫£ c√°c c·∫≠p nh·∫≠t d·ªØ li·ªáu ph·∫£i ƒë∆∞·ª£c th·ª±c hi·ªán tr√™n c√°c node c√πng m·ªôt th·ªùi ƒëi·ªÉm. Nh∆∞ng n·∫øu ƒë∆∞·ªùng k·∫øt n·ªëi (m·∫°ng) gi·ªØa c√°c node kh√¥ng ƒë∆∞·ª£c ƒë·∫£m b·∫£o d·∫´n ƒë·∫øn vi·ªác c√°c node s·∫Ω kh√¥ng ƒë∆∞·ª£c update d·ªØ li·ªáu c√πng m·ªôt th·ªùi ƒëi·ªÉm, ƒëi·ªÅu n√†y d·∫´n t·ªõi vi·ªác m·ªôt v√†i node d·ªØ li·ªáu s·∫Ω b·ªã out-of-date do ch∆∞a ƒë∆∞·ª£c c·∫≠p nh·∫≠t d·ªØ li·ªáu t·ª´ ƒë√≥ vi ph·∫°m t√≠nh C (consistency). V√† ƒë·ªÉ ƒë·∫£m b·∫£o ƒë·ªëi ph√≥ v·ªõi ƒëi·ªÅu n√†y ta s·∫Ω ng·ª´ng ph·ª•c v·ª• nh·ªØg node b·ªã out-of-date ƒë√≥ cho t·ªõi khi n√≥ ƒë∆∞·ª£c update d·ªØ li·ªáu ƒë·∫ßy ƒë·ªß, nh∆∞ng vi·ªác n√†y l·∫°i vi ph·∫°m t√≠nh A (availability) c·ªßa h·ªá th·ªëng.</p>
<p>Th√¥ng th∆∞·ªùng, ng∆∞·ªùi ta th∆∞·ªùng ƒë√°nh ƒë·ªïi y·∫øu t·ªë C ƒë·ªÉ l·∫•y hai y·∫øu t·ªë A v√† P. Khi ƒë√≥ h·ªç s·∫Ω thay th·∫ø Consistency th√†nh eventually consistency (t√≠nh nh·∫•t qu√°n c√≥ ƒë·ªô tr·ªÖ), l√†m nh∆∞ th·∫ø h·ªá th·ªëng s·∫Ω c√≥ hi·ªáu nƒÉng t·ªët h∆°n</p>
<h2 id="ph·∫ßn-10-consistent-hashing">Ph·∫ßn 10: Consistent Hashing</h2>
<p>Nh∆∞ ƒë√£ nh·∫Øc ƒë·∫øn r·∫•t nhi·ªÅu l·∫ßn b√™n tr√™n th√¨ Distributed Hash Table (DHT ‚Äî B·∫£ng bƒÉm ph√¢n t√°n) l√† m·ªôt th√†nh ph·∫ßn c∆° b·∫£n trong nh·ªØng distributed scalable systems (h·ªá th·ªëng ph√¢n t√°n c√≥ kh·∫£ nƒÉng m·ªü r·ªông). M·ªôt Hash Table c·∫ßn m·ªôt c·∫∑p key-value, v√† m·ªôt h√†m ‚Äúhash‚Äù ƒë·ªÉ map key v·ªõi v·ªã tr√≠ m√† value c·ªßa n√≥ ƒë∆∞·ª£c l∆∞u tr·ªØ.</p>
<p>index = hash_function(key)</p>
<p>Gi·∫£ s·ª≠ ta c√≥ thi·∫øt k·∫ø m·ªôt distributed caching system (Redis cache ch·∫≥ng h·∫°n). Ch√∫ng ta c√≥ ‚Äún‚Äù cache servers, th√¨ h√†m bƒÉm (hash function) ƒë·ªÉ map key v·ªõi v·ªã tr√≠ c·ªßa Cach server n√≥ l√†m ·ªü ƒë√¢u s·∫Ω l√† key % n. N√≥ r·∫•t ƒë∆°n gi·∫£n v√† d·ªÖ s·ª≠ d·ª•ng, tuy nhi√™n n√≥ c√≥ hai nh∆∞·ª£c ƒëi·ªÉm ch√≠nh l√†:</p>
<p>N√≥ r·∫•t kh√≥ horizontally scalable (ph√¢n t√°n theo chi·ªÅu ngang). B·ªüi v√¨ m·ªói l·∫ßn m·ªôt cache server m·ªõi ƒë∆∞·ª£c th√™m v√†o LB, m·ªçi mapping tr∆∞·ªõc khia gi·ªØa key v·ªõi value n√≥ ƒë∆∞·ª£c l∆∞u tr·ªØ ·ªü ƒë√¢u s·∫Ω sai to√©t h·∫øt. Hi·ªán t∆∞·ª£ng cache miss s·∫Ω s·∫©y ra tr√†n lan v√† r·∫•t m·∫•t th·ªùi gian v√† kh√≥ khƒÉn ƒë·ªÉ c·∫≠p nh·∫≠t t·∫•t c·∫£ c√°c mapping key-value, v·ªõi m·ªôt h·ªá th·ªëng l·ªõn v·ªõi s·ªë l∆∞·ª£ng caching data kh·ªïng l·ªì ƒë√¢y l√† m·ªôt ƒëi·ªÉm √°c m·ªông v·ªõi nh·ªØng ng∆∞·ªùi qu·∫£n l√Ω d·ªØ li·ªáu.
N√≥ c√≥ th·ªÉ kh√¥ng ƒë√°p ·ª©ng ƒë∆∞·ª£c vi·ªác c√¢n b·∫±ng t·∫£i (Load Balanced), b·ªüi v√¨ ta kh√¥ng th·ªÉ ch·∫Øc ch·∫Øn r·∫±ng vi·ªác hash v√† mapping nh∆∞ v·∫≠y nh·ªØng data ƒë∆∞·ª£c l∆∞u tr·ªØ ·ªü c√°c server kh√°c nhau c√≥ ƒë·ªô truy c·∫≠p c√≥ c√¢n b·∫±ng nhau kh√¥ng? R·∫•t c√≥ th·ªÉ nh·ªØng data √≠t ƒë∆∞·ª£c truy c·∫≠p c√≥ th·ªÉ t·∫≠p chung v√†o m·ªôt v√†i server v√† v√†i server c√≤n l·∫°i l·∫°i ch·ª©a nh·ªØng ‚Äúhot key‚Äù, d·∫´n t·ªõi t√¨nh trang m·ªôt v√†i server th√¨ ho·∫°t ƒë·ªông h·∫øt c√¥ng xu·∫•t, m·ªôt v√†i server th√¨ l·∫°i qu√° nh√†n r·ªói ng·ªìi ch∆°i kh√¥ng üòô.
V·ªõi nh·ªØng v·∫•n ƒë·ªÅ nh∆∞ v·∫≠y th√¨ Consistent Hashing l√† m·ªôt gi·∫£i ph√°p r·∫•t t·ªët ƒë·ªÉ c·∫£i ti·∫øn vi·ªác chia server v·ªõi c√°c caching system.</p>
<p>Consistent Hashing gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y nh∆∞ th·∫ø n√†o ?
Consistent Hashing l√† m·ªôt chi·∫øn thu·∫≠t hi·ªáu qu·∫£ cho vi·ªác ph√¢n chia distributed caching systems v√† DHT. N√≥ cho ph√©p vi·ªác th√™m hay x√≥a c√°c node tr√™n m·ªôt c·ª•m server (cluster) m√† √≠t g√¢y ra s·ª± x√°o tr·ªôn d·ªØ li·ªáu, do ƒë√≥ n√≥ c√°c h·ªá th·ªëng caching system s·∫Ω d·ªÖ d√†ng scale-up hay scale down.</p>
<p>Trong Consistent Hashing, khi b·∫£ng bƒÉm (hash table) thay ƒë·ªïi k√≠ch th∆∞·ªõc (v√≠ d·ª• th√™m m·ªôt node v√† cluster), ch·ªâ c√≥ ‚Äúk/n‚Äù keys c·∫ßn re-map v·ªõi ‚Äúk‚Äù l√† t·ªïng s·ªë keys c√≥ trong h·ªá th·ªëng, v√† ‚Äún‚Äù l√† t·ªïng s·ªë server. C√≥ nghƒ©a l√† khi thay ƒë·ªïi k√≠ch th∆∞·ªõc c·ªßa cluster th√¨ c√≥ duy nh·∫•t keys tr√™n m·ªôt server c·∫ßn ph·∫£i re-map. V√† khi m·ªôt node b·ªã x√≥a kh·ªèi cluster, th√¨ c√°c data c·ªßa node ƒë√≥ s·∫Ω ƒë∆∞·ª£c di chuy·ªÉn v√† chia s·∫ª v·ªõi c√°c node kh√°c, v√† c≈©ng t∆∞∆°ng t·ª± khi m·ªôt node ƒë∆∞·ª£c th√™m v√†o cluster th√¨ n√≥ s·∫Ω l·∫•y t·ª± ƒë·ªông d·ªØ li·ªáu t·ª´ m·ªôt v√†i node kh√°c ƒë·ªÉ chia s·∫ª t√†i nguy√™n.</p>
<p>Consistent Hashing ho·∫°t ƒë·ªông nh∆∞ th·∫ø n√†o?
V·∫≠y l√†m th·∫ø n√†o ƒë·ªÉ Consistent Hashing l√†m ƒë∆∞·ª£c nh·ªØng ƒëi·ªÅu tr√™n th√¨ c√°c Node tr√™n cluster s·∫Ω ƒë∆∞·ª£c l∆∞u tr·ªØ d∆∞·ªõi d·∫°ng v√≤ng tr√≤n b·∫±ng c√°ch s·ª≠ d·ª•ng hash function trong Consisten Hashing s·∫Ω hash c√°c key th√†nh m·ªôt m·ªôt s·ªë nguy√™n (Integer) n·∫±m trong m·ªôt kho·∫£ng n√†o ƒë√≥ v√† c√°c s·ªë nguy√™n ƒë√≥ s·∫Ω ƒë∆∞·ª£c ƒë·∫∑t tr√™n m·ªôt v√≤ng tr√≤n sao cho m·ªói ƒëi·ªÉm tr√™n v√≤ng tr√≤n s·∫Ω t∆∞∆°ng ·ª©ng v·ªõi m·ªôt s·ªë nguy√™n tr√™n d√£y s·ªë nguy√™n ƒë√≥.</p>
<p>T√≥m l·∫°i c√°c b∆∞·ªõc ƒë·ªÉ Consistent Hashing bƒÉm d·ªØ li·ªáu nh∆∞ sau:</p>
<p>Ti·∫øn h√†nh hash c√°c danh s√°ch node trong cluster server th√†nh m·ªôt s·ªë nguy√™n trong m·ªôt kho·∫£ng s·ªë ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a tr∆∞·ªõc. Kho·∫£ng s·ªë n√†y t√πy v√†o ng∆∞·ªùi thi·∫øt k·∫ø h·ªá th·ªëng c√¢n nh·∫Øc d·ª±a tr√™n s·ªë l∆∞·ª£ng Server t·ªëi ƒëa m√† h·ªá th·ªëng s·∫µn s√†ng scale up.
Sau khi ƒë√£ c√≥ danh s√°ch mapping gi·ªØa c√°c node, ta s·∫Ω ti·∫øn h√†nh mapping key c·ªßa data t·ªõi c√°c node b·∫±ng c√°ch.
Hash gi√° tr·ªã c·ªßa key th√†nh m·ªôt s·ªë nguy√™n (integer).
Di chuy·ªÉn n√≥ li√™n t·ª•c trong v√≤ng tr√≤n s·ªë nguy√™n trong kho·∫£ng ƒë√£ t·∫°o ·ªü tr√™n theo chi·ªÅu kim ƒë·ªìng h·ªì cho t·ªõi khi gi√° tr·ªã integer ƒë√≥ b·∫±ng v·ªõi gi√° tr·ªã hash key c·ªßa m·ªôt Node ƒë·∫ßu ti√™n n√≥ g·∫∑p. Ti·∫øn h√†nh ghi d·ªØ li·ªáu c·ªßa d·ªØ li·ªáu ƒë√≥ v√†o Node v·ª´a g·∫∑p.</p>
<p>M√¥ h√¨nh v√≤ng tr√≤n trong Consistent Hashing
Do ƒë√≥ khi ti·∫øn h√†nh th√™m m·ªôt Node v√†o Cluster Server th√¨ d·ªØ li·ªáu Node g·∫ßn n√≥ nh·∫•t theo chi·ªÅu kim ƒë·ªìng h·ªì s·∫Ω ƒë∆∞·ª£c chia s·∫ª v·ªõi Node m·ªõi th√™m v√†o.</p>
<p>M√¥ h√¨nh Consisten Hashing v·ªõi tr∆∞·ªùng h·ª£p th√™m m·ªõi Node
T∆∞∆°ng t·ª± nh∆∞ vi·ªác x√≥a m·ªôt Node tr√™n Cluster, khi cache miss s·∫©y ra, d·ªØ li·ªáu s·∫Ω ƒë∆∞·ª£c di chuy·ªÉn, l∆∞u v√† l·∫•y t·ª´ Node k·∫ø c·∫≠n nh·∫•t v·ªõi Node ƒë√£ x√≥a theo chi·ªÅu kim ƒë·ªìng h·ªì.</p>
<p>M√¥ h√¨nh Consisten Hashing v·ªõi tr∆∞·ªùng h·ª£p x√≥a m·ªõi m·ªôt Node
Nh∆∞ v·∫≠y, Consistent Hashing ƒë√£ gi·∫£i quy·∫øt ƒë∆∞·ª£c v·∫•n ƒë·ªÅ x√°o tr·ªôn data cache khi scale h·ªá th·ªëng theo chi·ªÅu ngang, ƒë·∫£m b·∫£o s·ª± x√°o tr·ªôn cache ch·ªâ x·∫£y ra v·ªõi m·ªôt server.</p>
<p>V·∫•n ƒë·ªÅ v·ªÅ ph√¢n ph·ªëi ƒë·ªÅu data tr√™n t·ª´ng Node.
B√™n tr√™n ch√∫ng ta c≈©ng ƒë√£ ƒë·ªÅ c·∫≠p v·ªÅ v·∫•n ƒë·ªÅ Load Balancing, v·ªõi d·ªØ li·ªáu th·∫≠t th√¨ kh·∫£ nƒÉng nhi·ªÅu data key ƒë·ªÅu ƒë∆∞·ª£c hash v√†o m·ªôt d√£y gi√° tr·ªã l∆∞u tr√™n m·ªôt Node n√†o ƒë√≥, khi·∫øn Node ƒë√≥ tr·ªü th√†nh ƒëi·ªÉm n√≥ng (hot spot) so v·ªõi c√°c server c√≤n l·∫°i. D·∫´n ƒë·∫øn vi·ªác l·ªách c√¢n b·∫±ng t·∫£i v√† r·ªßi ro n·∫øu node hot spot g·∫∑p s·ª± c·ªë, g·∫ßn nh∆∞ to√†n b·ªô cache s·∫Ω b·ªã m·∫•t, d·∫´n t·ªõi cache miss h√†ng lo·∫°t.</p>
<p>ƒê·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ n√†y, ch√∫ng ta s·∫Ω th·ª±c hi·ªán hash v√† th√™m nhi·ªÅu c√°c Node ·∫£o (virtual node) v√†o v√≤ng tr√≤n. V√† thay v√¨ vi·ªác ch·ªâ mapping m·ªói Node v√†o m·ªôt ƒëi·ªÉm tr√™n v√≤ng tr√≤n, m·ªói node ·∫£o t∆∞·ª£ng tr∆∞ng cho m·ªôt d√£y gi√° tr·ªã m√† m·ªôt Node th·∫≠t ƒë·∫£m nhi·ªám. C√≥ nghƒ©a l√† m·ªói Node th·∫≠t s·∫Ω l∆∞u tr·ªØ d·ªØ li·ªáu ƒë∆∞·ª£c √°nh x·∫° tr√™n nhi·ªÅu Virtual Node. ƒêi·ªÅu n√†y s·∫Ω l√†m cho vi·ªác ph√¢n ph·ªëi key s·∫Ω c√¢n b·∫±ng h∆°n, n√≥ gi·ªëng v·ªõi vi·ªác t·∫°o ra nhi·ªÅu Node con h∆°n cho hash function trong Consistent Hashing bƒÉm ‚Äúnhuy·ªÖn‚Äù h∆°n üòÉ</p>
<p>V√≠ d·ª• ta c√≥ 3 Node tr√™n Cluster, ta s·∫Ω t·∫°o th√™m 3 virtual Node t∆∞∆°ng ·ª©ng, l√∫c n√†y v√≤ng tr√≤n s·∫Ω chia th√†nh 6 ƒëi·ªÉm nh∆∞ tr√™n h√¨nh v·∫Ω. M·ªói Virtual Node s·∫Ω √°nh x·∫° t·ªõi c√°c Node th·∫≠t, nh∆∞ trong h√¨nh l√† Virutal Node m·∫ßu ƒë·ªè üî¥ s·∫Ω ·∫£nh x·∫° t·ªõi Real Node m·∫ßu ƒë·ªè üî¥, Virutal Node m·∫ßu xanh n∆∞·ªõc bi·ªÉn üîµ s·∫Ω √°nh x·∫° t·ªõi Real Node m·∫ßu xanh n∆∞·ªõc bi·ªÉn üîµ , t∆∞∆°ng t·ª± v·ªõi Virtual Nod m·∫ßu xanh nh·∫°t. Do v·∫≠y v·ªõi Node üî¥ n√≥ s·∫Ω ch·ª©a d·ªØ li·ªáu c·ªßa kho·∫£ng 1 v√† 4 Node üîµ s·∫Ω ch·ª©a d·ªØ li·ªáu c·ªßa 2 v√† 5, t∆∞∆°ng t·ª± Node c√≤n l·∫°i s·∫Ω ch·ª©a d·ªØ li·ªáu c·ªßa 0 v√† 6.</p>
<p>Virtual Node tr√™n Consistent Hashing
Consistent Hashing ƒë∆∞·ª£c ·ª©ng d·ª•ng r·∫•t r·ªông r√£i n·ªïi b·∫≠t nh·∫•t l√† DynamoDB v√† Cassandra ƒë√£ ·ª©ng d·ª•ng n√≥ v√†o vi·ªác replicate d·ªØ li·ªáu gi·ªØa c√°c Server Node c·ªßa n√≥.</p>
<h2 id="ph·∫ßn-11-long-polling-vs-websockets-vs-server-sent-events">Ph·∫ßn 11: Long-Polling vs WebSockets vs Server-Sent Events</h2>
<p>Long-polling, WebSockets hay Server-Sent l√† nh·ªØng c√°ch giao ti·∫øp ph·ªï bi·∫øn gi·ªØa Client v√† Server v√≠ d·ª• nh·ªØng gi·ªØa Web-Browser v√† Web-Server. ƒê·∫ßu ti√™n ta h√£y ƒëi t√¨m hi·ªÉu v·ªÅ HTTP v√† c√°c b∆∞·ªõc c·ªßa n√≥ tr√™n m√¥i tr∆∞·ªùng Web nh∆∞ th·∫ø n√†o.</p>
<p>Client s·∫Ω m·ªü ra m·ªôt k·∫øt n·ªëi (connection) √† y√™u c·∫ßu (request) d·ªØ li·ªáu t·ª´ Server
Server s·∫Ω nh·∫≠n y√™u c·∫ßu v√† t√≠nh to√°n k·∫øt qu·∫£ tr·∫£ v·ªÅ
Server s·∫Ω tr·∫£ v·ªÅ (response) k·∫øt qu·∫£ cho Client v·ª´a m·ªü connection ƒë√≥</p>
<p>Ajax Polling:
Polling l√† m·ªôt k·ªπ thu·∫≠t ƒë∆∞·ª£c s·ª≠ d·ª•ng trong c√°c ·ª©ng d·ª•ng AJAX, √Ω t∆∞·ªüng c·ªßa n√≥ l√† client s·∫Ω li√™n t·ª•c g·ªçi t·ªõi server ƒë·ªÉ y√™u c·∫ßu d·ªØ li·ªáu m·ªõi (polls/requests data). Client s·∫Ω t·∫°o ra m·ªôt request v√† ƒë·ª£i k·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ Server, n·∫øu Server kh√¥ng t√¨m th·∫•y ho·∫∑c tr·∫£ k·∫øt qu·∫£ v·ªÅ ho·∫∑c k·∫øt qu·∫£ l√† r·ªóng (empty), th√¨ m·ªôt empty response s·∫Ω ƒë∆∞·ª£c g·ª≠i v·ªÅ.</p>
<p>Client s·∫Ω m·ªü m·ªôt connection v√† request d·ªØ li·ªáu t·ª´ Server th√¥ng qua c·ªïng k·∫øt n·ªëi HTTP.
Nh·ªØng request tr√™n s·∫Ω ƒë∆∞·ª£c g·ª≠i ƒë·∫øn Server theo ƒë·ªãnh k·ª≥ (intervals), v√≠ d·ª• m·ªói 1 gi√¢y s·∫Ω c√≥ m·ªôt request g·ª≠i ƒëi.
Server s·∫Ω t√≠nh to√°n v√† tr·∫£ v·ªÅ d·ªØ li·ªáu c≈©ng th√¥ng qua k·∫øt n·ªëi HTTP.
Client s·∫Ω l·∫∑p l·∫°i c·∫£ 3 b∆∞·ªõc tr√™n ƒë·ªÉ li√™n t·ª•c c·∫≠p nh·∫≠t ƒë∆∞·ª£c d·ªØ li·ªáu m·ªõi nh·∫•t t·ª´ Server.</p>
<p>V·∫•n ƒë·ªÅ c·ªßa Ajax Polling l√† Client ph·∫£i li√™n t·ª•c g·ª≠i request t·ªõi Server, do ƒë√≥ s·∫Ω t·∫°o ra r·∫•t nhi·ªÅu request v·ªõi kh√¥ng c√≥ response n√†o tr·∫£ v·ªÅ, g√¢y l√£ng ph√≠ HTTP traffic c·ªßa h·ªá th·ªëng.</p>
<p>HTTP Long-Polling
ƒê√¢y l√† m·ªôt bi·∫øn th·ªÉ c·ªßa HTTP Polling truy·ªÅn th·ªëng b·∫±ng c√°ch cho ph√©p Server ch·ªß ƒë·ªông ƒë·∫©y (push) th√¥ng tin t·ªõi Client khi c√≥ d·ªØ li·ªáu m·ªõi, b·∫±ng c√°ch Client s·∫Ω g·ª≠i request t·ªõi Server m√† kh√¥ng c·∫ßn Server ph·∫£i tr·∫£ d·ªØ li·ªáu v·ªÅ ngay l·∫≠p t·ª©c m√† s·∫Ω l√†m theo logic nh∆∞ b√™n d∆∞·ªõi:</p>
<p>N·∫øu Server kh√¥ng c√≥ d·ªØ li·ªáu m·ªõi, thay v√¨ kh√¥ng tr·∫£ v·ªÅ hay tr·∫£ v·ªÅ d·ªØ li·ªáu r·ªóng, v√¨ Server s·∫Ω gi·ªØ request ƒë√≥ v√† ƒë·ª£i cho t·ªõi khi c√≥ d·ªØ li·ªáu m·ªõi v·ªÅ.
Khi d·ªØ li·ªáu ƒë√£ s·∫µn s√†ng th√¨ Server s·∫Ω g·ª≠i tr·∫£ (response) v·ªÅ cho Client. Ngay l√∫c ƒë√≥ Client l·∫°i ti·∫øp t·ª•c g·ª≠i m·ªôt request t·ªõi Server, v√¨ th·∫ø ·ªü ph√≠a Server s·∫Ω lu√¥n lu√¥n c√≥ m·ªôt request m√† n√≥ c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë·ªÉ lu√¥n c·∫≠p nh·∫≠t d·ªØ li·ªáu v·ªÅ ph√≠a Client.
V√† m·ªôt v√≤ng ƒë·ªùi c·ªßa m·ªôt HTTP Long-Polling s·∫Ω nh∆∞ sau:</p>
<p>Client t·∫°o m·ªôt HTTP request v·ªÅ ph√≠a Server v√† ch·ªù ƒë·ª£i t·ªõi khi c√≥ response tr·∫£ v·ªÅ.
Server s·∫Ω ch·ªù cho t·ªõi khi c√≥ d·ªØ li·ªáu tr·∫£ v·ªÅ ho·∫∑c qu√° th·ªùi gian time-out.
Khi c√≥ d·ªØ li·ªáu Server s·∫Ω tr·∫£ v·ªÅ cho Client (HTTP respone)
Client sau khi nh·∫≠n ƒë∆∞·ª£c d·ªØ li·ªáu tr·∫£ v·ªÅ ho·∫∑c qu√° time-out s·∫Ω g·ª≠i ti·∫øp m·ªôt HTTP Long-Polling ƒë·∫øn Server. L√∫c n√†y s·∫Ω c√≥ m·ªôt kho·∫£ng th·ªùi gian tr·ªÖ gi·ªØa l√∫c client nh·∫≠n v√† g·ª≠i request m·ªõi, nh∆∞ng th·ªùi gian tr·ªÖ n√†y t·∫°m ch·∫•p nh·∫≠nd ƒë∆∞·ª£c.
M·ªói HTTP Long-Polling s·∫Ω c√≥ m·ªôt kho·∫£ng time-out, n·∫øu qu√° th·ªùi time-out connection s·∫Ω ƒë√≥ng l·∫°i v√† m·ªü l·∫°i m·ªôt connection m·ªõi.</p>
<p>Web-socket
Websocket l√† giao th·ª©c chu·∫©n cho trao ƒë·ªïi d·ªØ li·ªáu hai chi·ªÅu gi·ªØa client v√† server hay c√≤n g·ªçi l√† k√™nh Full Duplex. Giao th·ª©c WebSocket kh√¥ng ch·∫°y tr√™n HTTP, thay v√†o ƒë√≥ n√≥ th·ª±c hi·ªán tr√™n giao th·ª©c TCP.</p>
<p>N√≥ cung c·∫•p m·ªôt ph∆∞∆°ng th·ª©c li√™n t·ª•c gi·ªØa Client v√† Server m√† c·∫£ hai b√™n c√≥ th·ªÉ g·ª≠i d·ªØ li·ªáu cho nhau b·∫•t k·ª≥ l√∫c n√†o. Client k·∫øt n·ªëi v·ªõi Server th√¥ng qua Websocket b·∫±ng m·ªôt c√∫ b·∫Øt tay (WebSocket handshake), n·∫øu n√≥ th√†nh c√¥ng th√¨ d·ªØ li·ªáu c√≥ th·ªÉ ƒë∆∞·ª£c trao ƒë·ªïi t·ª´ hai h∆∞·ªõng b·∫•t k·ª≥ l√∫c n√†o.</p>
<p>Ng∆∞·ªùi ta th∆∞·ªùng d√πng Websocket thay v√¨ HTTP cho nh·ªØng tr∆∞·ªùng h·ª£p y√™u c·∫ßu real time (th·ªùi gian th·ª±c) b·ªüi v√¨ g√≥i tin c·ªßa WebSockets nh·∫π h∆°n HTTP r·∫•t nhi·ªÅu, gi·∫£m ƒë·ªô tr·ªÖ c·ªßa network v√† kh√¥ng c·∫ßn ph·∫£i g·ª≠i request li√™n ti·∫øp nh∆∞ HTTP.</p>
<p>ƒêi·ªÅu n√†y ƒë∆∞·ª£c hi·ªán th·ª±c b·∫±ng cung c·∫•p m√¥t chu·∫©n h√≥a truy·ªÅn tin gi·ªØa Server v√† client th√¥ng qua c·ªïng ws:// ho·∫∑c wss:// c√≥ th√™m b·∫£o m·∫≠t. V√† d·ªØ li·ªáu truy·ªÅn ƒëi ch·∫•p nh·∫≠n ki·ªÉu String v√† Binary Type ( large objects (blobs), ArrayBuffers)</p>
<p>Server-Sent Events (SSEs)
SSEs c≈©ng g·∫ßn gi·ªëng v·ªõi Long-Polling nh∆∞ng kh√°c l√† connection s·∫Ω ƒë∆∞·ª£c l∆∞u tr·ªØ (persistent) s·ª≠ d·ª•ng cho m·ªôt th·ªùi gian d√†i (long-terms) m√† kh√¥ng c√≥ time-out v√† ch·ªâ c√≥ Server s·∫Ω s·ª≠ d·ª•ng connection n√†y ƒë·ªÉ g·ª≠i d·ªØ li·ªáu v·ªÅ cho Client, v√† client ch·ªâ c√≥ request (GET) d·ªØ li·ªáu m√† kh√¥ng ƒë∆∞·ª£c ph√©p g·ª≠i d·ªØ li·ªáu (POST) l√™n Server.</p>
<p>V√≤ng ƒë·ªùi c·ªßa c·ªßa SSEs</p>
<p>Client y√™u c·∫ßu l·ªØ li·ªáu t·ª´ Server s·ª≠ d·ª•g k·∫øt n·ªëi HTTP th√¥ng th∆∞·ªùng.
Connection gi·ªØa client v√† server s·∫Ω ƒë∆∞·ª£c m·ªü v√† duy tr√¨.
B·∫•t k·ª≥ khi n√†o m√°y ch·ªß s·∫Ω g·ª≠i d·ªØ li·ªáu t·ªõi Client b·∫•t c·ª© khi n√†o c√≥ th√¥ng tin m·ªõi.
SSEs c≈©ng gi·ªëng WebSocket l√† th√≠ch h·ª£p v·ªõi c√°c ·ª©ng d·ª•ng th·ªùi gian th·ª±c (real time) nh∆∞ng kh√°c l√† SSEs ch·ªâ l√† m·ªôt chi·ªÅu (Half duplex) gi·ªØa Server t·ªõi Client.</p>
<p>~ H·∫øt ~</p>
<p>Ngu·ªìn tham kh·∫£o: <a class="link" href="https://www.educative.io/courses/grokking-the-system-design-interview"  target="_blank" rel="noopener"
    ></a></p>
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<!-- raw HTML omitted -->

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/system-design/">system design</a>
        
            <a href="/tags/text/">text</a>
        
    </section>


    </footer>


    
</article>

    

    

<aside class="related-contents--wrapper">
    <h2 class="section-title">Related contents</h2>
    <div class="related-contents">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/system-design-project/">
        
        
            <div class="article-image">
                <img src="/p/system-design-project/system_design.4837c3bd8cf5293d906028ee5c129814_huac571d42ebe43b23b89accb8e5d96ee3_114158_250x150_fill_box_smart1_3.png" 
                        width="250" 
                        height="150" 
                        loading="lazy"
                        alt="Featured image of post System Design Project"
                        
                        data-hash="md5-SDfDvYz1KT2QYCjuXBKYFA==">
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">System Design Project</h2>
        </div>
    </a>
</article>
            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "hugo-theme-stack" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (DISQUS) {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2020 - 
        
        2022 Nguy·ªÖn H·ªØu Tr∆∞·ªüng
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.11.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css"integrity="sha256-c0uckgykQ9v5k&#43;IqViZOZKc47Jn7KQil4/MP3ySA3F8="crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css"integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE="crossorigin="anonymous"
            >

            </main>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#c√°c-t√≠nh-ch·∫•t-ch√≠nh-c·ªßa-m·ªôt-h·ªá-th·ªëng-ph√¢n-t√°n">C√°c t√≠nh ch·∫•t ch√≠nh c·ªßa m·ªôt h·ªá th·ªëng ph√¢n t√°n.</a>
      <ol>
        <li><a href="#1-kh·∫£-nƒÉng-m·ªü-r·ªông-scalability">1. Kh·∫£ nƒÉng m·ªü r·ªông (Scalability)</a></li>
        <li><a href="#2-ƒë·ªô-tin-c·∫≠y-reliability">2. ƒê·ªô tin c·∫≠y (Reliability)</a></li>
        <li><a href="#3-t√≠nh-s·∫µn-s√†ng-availability">3. T√≠nh s·∫µn s√†ng (Availability)</a></li>
        <li><a href="#4-hi·ªáu-su·∫•t-efficiency">4. Hi·ªáu su·∫•t (Efficiency)</a></li>
        <li><a href="#5-t√≠nh-m·ªü-r·ªông-v√†-kh·∫£-nƒÉng-b·∫£o-tr√¨-manageability">5. T√≠nh m·ªü r·ªông v√† kh·∫£ nƒÉng b·∫£o tr√¨ (Manageability)</a></li>
      </ol>
    </li>
    <li><a href="#ph·∫ßn-2-c√¢n-b·∫±ng-t·∫£i-load-balancing">Ph·∫ßn 2: C√¢n b·∫±ng t·∫£i (Load balancing)</a></li>
    <li><a href="#ph·∫ßn-3-b·ªô-ƒë·ªám--caching">Ph·∫ßn 3: B·ªô ƒë·ªám ‚Äî Caching</a>
      <ol>
        <li><a href="#b·ªô-ƒë·ªám-t·∫ßng-backendapplication-server-cache">B·ªô ƒë·ªám t·∫ßng Backend(Application Server Cache)</a></li>
        <li><a href="#b·ªô-ƒë·ªám-t·∫ßng-frontend--content-distribution-network-cdn">B·ªô ƒë·ªám t·∫ßng Frontend ‚Äî Content Distribution Network (CDN)</a></li>
        <li><a href="#cache-invalidation">Cache Invalidation</a></li>
        <li><a href="#cache-eviction-policies">Cache eviction policies</a></li>
      </ol>
    </li>
    <li><a href="#ph·∫ßn-4-ph√¢n-chia-d·ªØ-li·ªáu--shardingdata-partitioning">Ph·∫ßn 4: Ph√¢n chia d·ªØ li·ªáu ‚Äî Sharding/Data Partitioning</a>
      <ol>
        <li><a href="#nh·ªØng-c√°ch-th·ª©c-ph√¢n-chia-d·ªØ-li·ªáu">Nh·ªØng c√°ch th·ª©c ph√¢n chia d·ªØ li·ªáu</a></li>
        <li><a href="#nh·ªØng-ti√™u-ch√≠-ƒë·ªÉ-ph√¢n-v√πng-d·ªØ-li·ªáu">Nh·ªØng ti√™u ch√≠ ƒë·ªÉ ph√¢n v√πng d·ªØ li·ªáu</a></li>
        <li><a href="#c√°c-v·∫•n-ƒë·ªÅ-khi-sharding-d·ªØ-li·ªáu">C√°c v·∫•n ƒë·ªÅ khi Sharding d·ªØ li·ªáu</a></li>
      </ol>
    </li>
    <li><a href="#ph·∫ßn-5-indexes">Ph·∫ßn 5: Indexes</a></li>
    <li><a href="#ph·∫ßn-6-proxies">Ph·∫ßn 6: Proxies</a></li>
    <li><a href="#ph·∫ßn-7-sao-l∆∞u-v√†-ƒë·ªìng-b·ªô-d·ªØ-li·ªáu--redundancy-and-replication">Ph·∫ßn 7: Sao l∆∞u v√† ƒë·ªìng b·ªô d·ªØ li·ªáu ‚Äî Redundancy and Replication</a></li>
    <li><a href="#ph·∫ßn-8-sql-vs-nosql">Ph·∫ßn 8: SQL vs. NoSQL</a></li>
    <li><a href="#ph·∫ßn-9-ƒë·ªãnh-l√Ω-cap--cap-theorem">Ph·∫ßn 9: ƒê·ªãnh l√Ω CAP / CAP Theorem</a></li>
    <li><a href="#ph·∫ßn-10-consistent-hashing">Ph·∫ßn 10: Consistent Hashing</a></li>
    <li><a href="#ph·∫ßn-11-long-polling-vs-websockets-vs-server-sent-events">Ph·∫ßn 11: Long-Polling vs WebSockets vs Server-Sent Events</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js"integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
